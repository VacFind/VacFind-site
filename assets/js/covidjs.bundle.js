!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("covidjs",[],e):"object"==typeof exports?exports.covidjs=e():t.covidjs=e()}(self,(function(){return(()=>{"use strict";var t={595:(t,e,r)=>{r.r(e),r.d(e,{AsyncAirtable:()=>E});var i=r(300);const o="undefined"!=typeof window?window.fetch.bind(window):i,n={$arrayCompact:t=>`ARRAYCOMPACT({${t}})`,$arrayFlatten:t=>`ARRAYFLATTEN({${t}})`,$arrayUnique:t=>`ARRAYUNIQUE({${t}})`,$arrayJoin:(t,e=",")=>`ARRAYJOIN({${t}}, '${e}')`},s=t=>{if(null===t)return"BLANK()";switch(typeof t){case"number":return`${t}`;case"string":return`'${t}'`;case"boolean":return(t=>{if("boolean"!=typeof t)throw new Error("Invalid type");return t?"TRUE()":"FALSE()"})(t);default:throw new Error("Wrong Type")}},a={$not:t=>`NOT(${w(t)})`,$and:t=>`AND(${w(t)})`,$or:t=>`OR(${w(t)})`},c=["=","!=",">",">=","<","<="],d=(t,e)=>{if("object"!=typeof t||Array.isArray(t))throw new Error("Missing or Invalid Comparison Object");if("string"!=typeof e&&!c.includes(e))throw new Error("Missing or Invalid Comparison Operator");const r=Object.keys(t),i=`${r.map(((i,o)=>{const n=w(t[i]);return`{${i}} ${e} ${n}${o<r.length-1?", ":""}`})).join("")}`;return r.length>1?`AND(${i})`:i},h={$gt:t=>d(t,">"),$lt:t=>d(t,"<"),$gte:t=>d(t,">="),$lte:t=>d(t,"<="),$eq:t=>d(t,"="),$neq:t=>d(t,"!=")},u={$textFind:(t,e,r=0)=>`FIND(${"string"==typeof t?s(t):w(t)}, ${"string"==typeof e?s(e):w(e)}, ${r})`,$textSearch:(t,e,r=0)=>`SEARCH(${"string"==typeof t?s(t):w(t)}, ${"string"==typeof e?s(e):w(e)}, ${r})`},y=t=>{if(void 0===t)throw new Error("Missing Query Object");return null!==t&&t instanceof Object&&!Array.isArray(t)},l=t=>t instanceof Array&&t.every((t=>y(t))),f=t=>t instanceof Array&&t.every((t=>"string"==typeof t)),p=t=>"string"==typeof t||t instanceof Object&&!Array.isArray(t)&&"string"==typeof(null==t?void 0:t.$fieldName),v=t=>t.every((t=>null!=t)),$=t=>"object"!=typeof t||null===t,w=t=>{var e,r;if(void 0!==t&&!(t instanceof Function)){if($(t))return s(t);if(t instanceof Array)return t.map((t=>w(t))).join(", ").trim();const i=Object.keys(t),o=Object.values(t);if(i.length>1&&v(o)&&l(i.map(((t,e)=>({[t]:o[e]})))))return a.$and(i.map(((t,e)=>({[t]:o[e]}))));const c=i[0];if(void 0===t[c])throw new Error("Invalid query");if("$fieldName"===c)return`{${t.$fieldName}}`;const d=t[c];if(void 0!==d){if(c in a&&(y(d)||l(d)))return a[c](d);if(c in n){if(f(d)&&f(r=d)&&2===r.length)return n[c](...d);if("string"==typeof d)return n[c](d)}else{if(c in u&&Array.isArray(d)&&(t=>t instanceof Array&&(3===t.length&&"number"==typeof t[2]||2===t.length&&(p(t[0])||y(t[0]))&&(p(t[1])||y(t[1]))))(d))return u[c](d[0],d[1],null!==(e=d[2])&&void 0!==e?e:0);if(y(d)){const t=Object.keys(d),e=Object.values(d);if(t.length>1&&v(e)&&l(t.map(((t,r)=>({[t]:e[r]}))))&&t.every((t=>t in h))&&e.every((t=>y(t)||$(t))))return a.$and(t.map(((t,r)=>({[c]:{[t]:e[r]}}))));const r=t[0],i=e[0];if(r in h&&(y(i)||$(i)))return h[r]({[c]:i})}else if(y(d)||$(d))return h.$eq({[c]:d})}}}throw new Error("Invalid Query Object")},b=t=>{if(Object.prototype.hasOwnProperty.call(t,"filterByFormula")&&Object.prototype.hasOwnProperty.call(t,"where"))throw new Error("Cannot use both where and filterByFormula as they accomplish the same thing");const e=Object.keys(t).map(((e,r)=>{const i=t[e];let o;return o=Array.isArray(i)?i.map(((t,r)=>{switch(typeof t){case"object":return Object.keys(t).map((i=>`${e}[${r}][${i}]=${t[i]}`)).join("&");case"string":return`${e}[]=${t}`}})).join("&"):"where"===e?`filterByFormula=${w(i)}`:`${e}=${i}`,0!==r?`&${o}`:o})).join("");return encodeURI(e)},m=t=>t>=300,g=(t,e,r,i=!0)=>{if(void 0===t&&i)throw new Error(`Argument "${e}" is required.`);if((void 0!==t||i)&&typeof t!==r){if("array"===r&&Array.isArray(t))return;throw new Error(`Incorrect data type on argument "${e}". Received "${typeof t}": expected "${r}"`)}};var R=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function s(t){try{c(i.next(t))}catch(t){n(t)}}function a(t){try{c(i.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};const O=(t,e,r,i,n)=>R(void 0,void 0,void 0,(function*(){return new Promise(((s,a)=>{const c=(t,e,r,i,n)=>{i&&i<1&&a("Max timeout exceeded"),setTimeout((()=>R(void 0,void 0,void 0,(function*(){try{const a=yield o(t,e),d=yield a.json();if(429===a.status)return c(t,e,1.5*r,i-r,n);s(n?d[n]:d)}catch(t){a(t)}}))),r)};c(t,e,r,i,n)}))}));var j=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function s(t){try{c(i.next(t))}catch(t){n(t)}}function a(t){try{c(i.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};const A=["fields","filterByFormula","maxRecords","pageSize","sort","view","where"];class E{constructor(t,e,r){if(this.select=(t,e,r)=>j(this,void 0,void 0,(function*(){try{g(t,"table","string"),g(e,"options","object",!1),g(r,"page","number",!1);const i=`${this.baseURL}/${this.base}/${t}`,n=e?Object.assign({},e):{};Object.keys(n).forEach((t=>{if(!A.includes(t))throw new Error(`Invalid option: ${t}`)}));let s="",a=[];if(r)for(let t=0;t<r;t++){s&&(n.offset=s);try{const e=yield o(`${i}?${b(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}}),a=yield e.json();if(m(e.status)){if(429!==e.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit&&t+1===r)return yield O(`${i}?${b(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry,"records")}if(t+1===r)return a.records;s=a.offset}catch(t){throw new Error(t)}}else{let t=!1;for(;!t;){s&&(n.offset=s);try{const e=yield o(`${i}?${b(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}}),r=yield e.json();if(m(e.status)){if(429!==e.status)throw new Error(JSON.stringify(r));if(this.retryOnRateLimit)return yield O(`${i}?${b(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry,"records")}a=a.concat(r.records),s=r.offset,r.offset||(t=!0)}catch(t){throw new Error(t)}}}return a}catch(t){throw new Error(t)}})),this.find=(t,e)=>j(this,void 0,void 0,(function*(){try{g(t,"table","string"),g(e,"id","string");const r=`${this.baseURL}/${this.base}/${t}/${e}`,i=yield o(r,{headers:{Authorization:`Bearer ${this.apiKey}`}}),n=yield i.json();if(m(i.status)){if(429!==i.status)throw new Error(JSON.stringify(n));if(this.retryOnRateLimit)return yield O(r,{headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry)}return n}catch(t){throw new Error(t)}})),this.createRecord=(t,e,r)=>j(this,void 0,void 0,(function*(){try{g(t,"table","string"),g(e,"record","object"),g(r,"typecast","boolean",!1);const i=`${this.baseURL}/${this.base}/${t}`,n={fields:e};void 0!==r&&(n.typecast=r);const s=yield o(i,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(m(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield O(i,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry)}return a}catch(t){throw new Error(t)}})),this.updateRecord=(t,e,r)=>j(this,void 0,void 0,(function*(){try{g(t,"table","string"),g(e,"record","object"),r&&(g(r.destructive,"opts.desctructive","boolean"),g(r.typecast,"opts.typecast","boolean",!1));const i=`${this.baseURL}/${this.base}/${t}/${e.id}`,n={fields:e.fields};void 0!==(null==r?void 0:r.typecast)&&(n.typecast=null==r?void 0:r.typecast);const s=yield o(i,{method:(null==r?void 0:r.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(m(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield O(i,{method:(null==r?void 0:r.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry)}return a}catch(t){throw new Error(t)}})),this.deleteRecord=(t,e)=>j(this,void 0,void 0,(function*(){try{g(t,"table","string"),g(e,"id","string");const r=`${this.baseURL}/${this.base}/${t}/${e}`,i=yield o(r,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}}),n=yield i.json();if(m(i.status)){if(429!==i.status)throw new Error(JSON.stringify(n));if(this.retryOnRateLimit)return yield O(r,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry)}return n}catch(t){throw new Error(t)}})),this.bulkCreate=(t,e,r)=>j(this,void 0,void 0,(function*(){try{g(t,"table","string"),g(e,"records","array"),g(r,"typecast","boolean",!1);const i=`${this.baseURL}/${this.base}/${t}`,n={records:e.map((t=>({fields:t})))};void 0!==r&&(n.typecast=r);const s=yield o(i,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(m(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield O(i,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry,"records")}return a.records}catch(t){throw new Error(t)}})),this.bulkUpdate=(t,e,r)=>j(this,void 0,void 0,(function*(){try{g(t,"table","string"),g(e,"records","array"),r&&(g(r.destructive,"opts.desctructive","boolean",!1),g(r.typecast,"opts.typecast","boolean",!1));const i=`${this.baseURL}/${this.base}/${t}`,n={records:e};void 0!==(null==r?void 0:r.typecast)&&(n.typecast=null==r?void 0:r.typecast);const s=yield o(i,{method:(null==r?void 0:r.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(m(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield O(i,{method:(null==r?void 0:r.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry,"records")}return a.records}catch(t){throw new Error(t)}})),this.bulkDelete=(t,e)=>j(this,void 0,void 0,(function*(){try{g(t,"table","string"),g(e,"ids","array");let r="";e.forEach(((t,e)=>{r=0!==e?`${r}&records[]=${t}`:`records[]=${t}`}));const i=`${this.baseURL}/${this.base}/${t}?${encodeURI(r)}`,n=yield o(i,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}}),s=yield n.json();if(m(n.status)){if(429!==n.status)throw new Error(JSON.stringify(s));if(this.retryOnRateLimit)return yield O(i,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry,"records")}return s.records}catch(t){throw new Error(t)}})),this.upsertRecord=(t,e,r,i)=>j(this,void 0,void 0,(function*(){g(t,"table","string"),g(e,"filterString","string"),g(r,"record","object"),i&&(g(i.destructive,"opts.desctructive","boolean",!1),g(i.typecast,"opts.typecast","boolean",!1));const o=yield this.select(t,{filterByFormula:e});return o[0]?yield this.updateRecord(t,{id:o[0].id,fields:r},i):yield this.createRecord(t,r,null==i?void 0:i.typecast)})),!t)throw new Error("API Key is required.");if(!e)throw new Error("Base ID is required.");this.apiKey=t,this.base=e,this.retryOnRateLimit=(null==r?void 0:r.retryOnRateLimit)||!0,this.retryTimeout=(null==r?void 0:r.retryTimeout)||5e3,this.maxRetry=(null==r?void 0:r.maxRetry)||6e4,this.baseURL=(null==r?void 0:r.baseURL)||"https://api.airtable.com/v0"}}"undefined"!=typeof window&&(window.AsyncAirtable=E)},300:(t,e)=>{var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r)return r;throw new Error("unable to locate global object")}();t.exports=e=r.fetch,r.fetch&&(e.default=r.fetch.bind(r)),e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response},607:function(t,e,r){var i=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function s(t){try{c(i.next(t))}catch(t){n(t)}}function a(t){try{c(i.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.VacFindBackend=e.VacFindRecord=void 0;const o=r(595),n=r(35);Object.defineProperty(e,"VacFindRecord",{enumerable:!0,get:function(){return n.VacFindRecord}}),e.VacFindBackend=class{constructor(){this.loadLinks=t=>i(this,void 0,void 0,(function*(){return this.asyncAirtable.select("links",{sort:[{field:"group",direction:"asc"}],where:t}).then((t=>this.persistToStorage(t))).then((t=>t.map((t=>new n.VacFindRecord(t)))))})),this.persistToStorage=t=>(console.log("persisting to storage"),t&&localStorage.setItem("vacFind-links",JSON.stringify(t)),t),this.retrieveFromStorage=()=>{console.log("retrieving from storage");const t=localStorage.getItem("vacFind-links");return t?JSON.parse(t):[]},this.baseID="appGzEQkD3QySIDvj",this.apiKey="keyyCSADD61J0D4wQ",this.baseURL="https://api.vacfind.org/v0",this.asyncAirtable=new o.AsyncAirtable(this.apiKey,this.baseID,{baseURL:this.baseURL})}}},35:function(t,e){var r,i=this&&this.__classPrivateFieldSet||function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},o=this&&this.__classPrivateFieldGet||function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.VacFindRecord=void 0,e.VacFindRecord=class{constructor(t){r.set(this,void 0),this.isOfficialResource=()=>"government resource"==this.raw_record.fields.verification_status||"government"==this.raw_record.fields.source_type,i(this,r,t)}get raw_record(){return o(this,r)}get group(){return o(this,r).fields.group}get url(){return o(this,r).fields.url}get linkTitle(){return o(this,r).fields.link_title}get airtableID(){return o(this,r).id}get recordID(){return o(this,r).fields.id}},r=new WeakMap}},e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,r),o.exports}return r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(607)})()}));
(()=>{"use strict";var t={300:(t,e)=>{var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r)return r;throw new Error("unable to locate global object")}();t.exports=e=r.fetch,r.fetch&&(e.default=r.fetch.bind(r)),e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response}},e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={exports:{}};return t[i](o,o.exports,r),o.exports}(()=>{var t=r(300);const e="undefined"!=typeof window?window.fetch.bind(window):t,i={$arrayCompact:t=>`ARRAYCOMPACT({${t}})`,$arrayFlatten:t=>`ARRAYFLATTEN({${t}})`,$arrayUnique:t=>`ARRAYUNIQUE({${t}})`,$arrayJoin:(t,e=",")=>`ARRAYJOIN({${t}}, '${e}')`},o=t=>{if(null===t)return"BLANK()";switch(typeof t){case"number":return`${t}`;case"string":return`'${t}'`;case"boolean":return(t=>{if("boolean"!=typeof t)throw new Error("Invalid type");return t?"TRUE()":"FALSE()"})(t);default:throw new Error("Wrong Type")}},n={$not:t=>`NOT(${$(t)})`,$and:t=>`AND(${$(t)})`,$or:t=>`OR(${$(t)})`},s=["=","!=",">",">=","<","<="],a=(t,e)=>{if("object"!=typeof t||Array.isArray(t))throw new Error("Missing or Invalid Comparison Object");if("string"!=typeof e&&!s.includes(e))throw new Error("Missing or Invalid Comparison Operator");const r=Object.keys(t),i=`${r.map(((i,o)=>{const n=$(t[i]);return`{${i}} ${e} ${n}${o<r.length-1?", ":""}`})).join("")}`;return r.length>1?`AND(${i})`:i},c={$gt:t=>a(t,">"),$lt:t=>a(t,"<"),$gte:t=>a(t,">="),$lte:t=>a(t,"<="),$eq:t=>a(t,"="),$neq:t=>a(t,"!=")},d={$textFind:(t,e,r=0)=>`FIND(${"string"==typeof t?o(t):$(t)}, ${"string"==typeof e?o(e):$(e)}, ${r})`,$textSearch:(t,e,r=0)=>`SEARCH(${"string"==typeof t?o(t):$(t)}, ${"string"==typeof e?o(e):$(e)}, ${r})`},y=t=>{if(void 0===t)throw new Error("Missing Query Object");return null!==t&&t instanceof Object&&!Array.isArray(t)},h=t=>t instanceof Array&&t.every((t=>y(t))),u=t=>t instanceof Array&&t.every((t=>"string"==typeof t)),l=t=>"string"==typeof t||t instanceof Object&&!Array.isArray(t)&&"string"==typeof(null==t?void 0:t.$fieldName),f=t=>t.every((t=>null!=t)),p=t=>"object"!=typeof t||null===t,$=t=>{var e,r;if(void 0!==t&&!(t instanceof Function)){if(p(t))return o(t);if(t instanceof Array)return t.map((t=>$(t))).join(", ").trim();const s=Object.keys(t),a=Object.values(t);if(s.length>1&&f(a)&&h(s.map(((t,e)=>({[t]:a[e]})))))return n.$and(s.map(((t,e)=>({[t]:a[e]}))));const w=s[0];if(void 0===t[w])throw new Error("Invalid query");if("$fieldName"===w)return`{${t.$fieldName}}`;const v=t[w];if(void 0!==v){if(w in n&&(y(v)||h(v)))return n[w](v);if(w in i){if(u(v)&&u(r=v)&&2===r.length)return i[w](...v);if("string"==typeof v)return i[w](v)}else{if(w in d&&Array.isArray(v)&&(t=>t instanceof Array&&(3===t.length&&"number"==typeof t[2]||2===t.length&&(l(t[0])||y(t[0]))&&(l(t[1])||y(t[1]))))(v))return d[w](v[0],v[1],null!==(e=v[2])&&void 0!==e?e:0);if(y(v)){const t=Object.keys(v),e=Object.values(v);if(t.length>1&&f(e)&&h(t.map(((t,r)=>({[t]:e[r]}))))&&t.every((t=>t in c))&&e.every((t=>y(t)||p(t))))return n.$and(t.map(((t,r)=>({[w]:{[t]:e[r]}}))));const r=t[0],i=e[0];if(r in c&&(y(i)||p(i)))return c[r]({[w]:i})}else if(y(v)||p(v))return c.$eq({[w]:v})}}}throw new Error("Invalid Query Object")},w=t=>{if(Object.prototype.hasOwnProperty.call(t,"filterByFormula")&&Object.prototype.hasOwnProperty.call(t,"where"))throw new Error("Cannot use both where and filterByFormula as they accomplish the same thing");const e=Object.keys(t).map(((e,r)=>{const i=t[e];let o;return o=Array.isArray(i)?i.map(((t,r)=>{switch(typeof t){case"object":return Object.keys(t).map((i=>`${e}[${r}][${i}]=${t[i]}`)).join("&");case"string":return`${e}[]=${t}`}})).join("&"):"where"===e?`filterByFormula=${$(i)}`:`${e}=${i}`,0!==r?`&${o}`:o})).join("");return encodeURI(e)},v=t=>t>=300,b=(t,e,r,i=!0)=>{if(void 0===t&&i)throw new Error(`Argument "${e}" is required.`);if((void 0!==t||i)&&typeof t!==r){if("array"===r&&Array.isArray(t))return;throw new Error(`Incorrect data type on argument "${e}". Received "${typeof t}": expected "${r}"`)}};var m=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function s(t){try{c(i.next(t))}catch(t){n(t)}}function a(t){try{c(i.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};const g=(t,r,i,o,n)=>m(void 0,void 0,void 0,(function*(){return new Promise(((s,a)=>{const c=(t,r,i,o,n)=>{o&&o<1&&a("Max timeout exceeded"),setTimeout((()=>m(void 0,void 0,void 0,(function*(){try{const a=yield e(t,r),d=yield a.json();if(429===a.status)return c(t,r,1.5*i,o-i,n);s(n?d[n]:d)}catch(t){a(t)}}))),i)};c(t,r,i,o,n)}))}));var R=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function s(t){try{c(i.next(t))}catch(t){n(t)}}function a(t){try{c(i.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};const A=["fields","filterByFormula","maxRecords","pageSize","sort","view","where"];"undefined"!=typeof window&&(window.AsyncAirtable=class{constructor(t,r,i){if(this.select=(t,r,i)=>R(this,void 0,void 0,(function*(){try{b(t,"table","string"),b(r,"options","object",!1),b(i,"page","number",!1);const o=`${this.baseURL}/${this.base}/${t}`,n=r?Object.assign({},r):{};Object.keys(n).forEach((t=>{if(!A.includes(t))throw new Error(`Invalid option: ${t}`)}));let s="",a=[];if(i)for(let t=0;t<i;t++){s&&(n.offset=s);try{const r=yield e(`${o}?${w(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}}),a=yield r.json();if(v(r.status)){if(429!==r.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit&&t+1===i)return yield g(`${o}?${w(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry,"records")}if(t+1===i)return a.records;s=a.offset}catch(t){throw new Error(t)}}else{let t=!1;for(;!t;){s&&(n.offset=s);try{const r=yield e(`${o}?${w(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}}),i=yield r.json();if(v(r.status)){if(429!==r.status)throw new Error(JSON.stringify(i));if(this.retryOnRateLimit)return yield g(`${o}?${w(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry,"records")}a=a.concat(i.records),s=i.offset,i.offset||(t=!0)}catch(t){throw new Error(t)}}}return a}catch(t){throw new Error(t)}})),this.find=(t,r)=>R(this,void 0,void 0,(function*(){try{b(t,"table","string"),b(r,"id","string");const i=`${this.baseURL}/${this.base}/${t}/${r}`,o=yield e(i,{headers:{Authorization:`Bearer ${this.apiKey}`}}),n=yield o.json();if(v(o.status)){if(429!==o.status)throw new Error(JSON.stringify(n));if(this.retryOnRateLimit)return yield g(i,{headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry)}return n}catch(t){throw new Error(t)}})),this.createRecord=(t,r,i)=>R(this,void 0,void 0,(function*(){try{b(t,"table","string"),b(r,"record","object"),b(i,"typecast","boolean",!1);const o=`${this.baseURL}/${this.base}/${t}`,n={fields:r};void 0!==i&&(n.typecast=i);const s=yield e(o,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(v(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield g(o,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry)}return a}catch(t){throw new Error(t)}})),this.updateRecord=(t,r,i)=>R(this,void 0,void 0,(function*(){try{b(t,"table","string"),b(r,"record","object"),i&&(b(i.destructive,"opts.desctructive","boolean"),b(i.typecast,"opts.typecast","boolean",!1));const o=`${this.baseURL}/${this.base}/${t}/${r.id}`,n={fields:r.fields};void 0!==(null==i?void 0:i.typecast)&&(n.typecast=null==i?void 0:i.typecast);const s=yield e(o,{method:(null==i?void 0:i.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(v(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield g(o,{method:(null==i?void 0:i.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry)}return a}catch(t){throw new Error(t)}})),this.deleteRecord=(t,r)=>R(this,void 0,void 0,(function*(){try{b(t,"table","string"),b(r,"id","string");const i=`${this.baseURL}/${this.base}/${t}/${r}`,o=yield e(i,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}}),n=yield o.json();if(v(o.status)){if(429!==o.status)throw new Error(JSON.stringify(n));if(this.retryOnRateLimit)return yield g(i,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry)}return n}catch(t){throw new Error(t)}})),this.bulkCreate=(t,r,i)=>R(this,void 0,void 0,(function*(){try{b(t,"table","string"),b(r,"records","array"),b(i,"typecast","boolean",!1);const o=`${this.baseURL}/${this.base}/${t}`,n={records:r.map((t=>({fields:t})))};void 0!==i&&(n.typecast=i);const s=yield e(o,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(v(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield g(o,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry,"records")}return a.records}catch(t){throw new Error(t)}})),this.bulkUpdate=(t,r,i)=>R(this,void 0,void 0,(function*(){try{b(t,"table","string"),b(r,"records","array"),i&&(b(i.destructive,"opts.desctructive","boolean",!1),b(i.typecast,"opts.typecast","boolean",!1));const o=`${this.baseURL}/${this.base}/${t}`,n={records:r};void 0!==(null==i?void 0:i.typecast)&&(n.typecast=null==i?void 0:i.typecast);const s=yield e(o,{method:(null==i?void 0:i.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(v(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield g(o,{method:(null==i?void 0:i.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry,"records")}return a.records}catch(t){throw new Error(t)}})),this.bulkDelete=(t,r)=>R(this,void 0,void 0,(function*(){try{b(t,"table","string"),b(r,"ids","array");let i="";r.forEach(((t,e)=>{i=0!==e?`${i}&records[]=${t}`:`records[]=${t}`}));const o=`${this.baseURL}/${this.base}/${t}?${encodeURI(i)}`,n=yield e(o,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}}),s=yield n.json();if(v(n.status)){if(429!==n.status)throw new Error(JSON.stringify(s));if(this.retryOnRateLimit)return yield g(o,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry,"records")}return s.records}catch(t){throw new Error(t)}})),this.upsertRecord=(t,e,r,i)=>R(this,void 0,void 0,(function*(){b(t,"table","string"),b(e,"filterString","string"),b(r,"record","object"),i&&(b(i.destructive,"opts.desctructive","boolean",!1),b(i.typecast,"opts.typecast","boolean",!1));const o=yield this.select(t,{filterByFormula:e});return o[0]?yield this.updateRecord(t,{id:o[0].id,fields:r},i):yield this.createRecord(t,r,null==i?void 0:i.typecast)})),!t)throw new Error("API Key is required.");if(!r)throw new Error("Base ID is required.");this.apiKey=t,this.base=r,this.retryOnRateLimit=(null==i?void 0:i.retryOnRateLimit)||!0,this.retryTimeout=(null==i?void 0:i.retryTimeout)||5e3,this.maxRetry=(null==i?void 0:i.maxRetry)||6e4,this.baseURL=(null==i?void 0:i.baseURL)||"https://api.airtable.com/v0"}})})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vbm9kZV9tb2R1bGVzL25vZGUtZmV0Y2gvYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2FzeW5jYWlydGFibGUvLi9zcmMvZmV0Y2gudHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9hcnJheUZ1bmN0aW9ucy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL2Jhc2VIYW5kbGVycy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL2xvZ2ljYWxGdW5jdGlvbnMudHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9idWlsZEV4cHJlc3Npb24udHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9sb2dpY2FsT3BlcmF0b3JzLnRzIiwid2VicGFjazovL2FzeW5jYWlydGFibGUvLi9zcmMvdGV4dEZ1bmN0aW9ucy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL3R5cGVDaGVja2Vycy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL3F1ZXJ5QnVpbGRlci50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL2J1aWxkT3B0cy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL2NoZWNrRXJyb3IudHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9jaGVja0FyZy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL3JhdGVMaW1pdEhhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9hc3luY0FpcnRhYmxlLnRzIl0sIm5hbWVzIjpbImdsb2JhbCIsInNlbGYiLCJ3aW5kb3ciLCJFcnJvciIsImdldEdsb2JhbCIsIm1vZHVsZSIsImV4cG9ydHMiLCJmZXRjaCIsImRlZmF1bHQiLCJiaW5kIiwiSGVhZGVycyIsIlJlcXVlc3QiLCJSZXNwb25zZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJhcnJheUZ1bmN0aW9ucyIsIiRhcnJheUNvbXBhY3QiLCJmaWVsZE5hbWUiLCIkYXJyYXlGbGF0dGVuIiwiJGFycmF5VW5pcXVlIiwiJGFycmF5Sm9pbiIsInNlcGVyYXRvciIsImJhc2VIYW5kbGVyIiwidmFsIiwiYm9vbCIsImJvb2xlYW5IYW5kbGVyIiwibG9naWNhbEZ1bmN0aW9ucyIsIiRub3QiLCJleHByZXNzaW9uIiwicXVlcnlCdWlsZGVyIiwiJGFuZCIsImFyZ3MiLCIkb3IiLCJvcGVyYXRvcnMiLCJidWlsZEV4cHJlc3Npb24iLCJvYmoiLCJvcCIsIkFycmF5IiwiaXNBcnJheSIsImluY2x1ZGVzIiwia2V5cyIsIk9iamVjdCIsImV4cCIsIm1hcCIsImsiLCJpIiwibGVuZ3RoIiwiam9pbiIsImxvZ2ljYWxPcGVyYXRvcnMiLCIkZ3QiLCIkbHQiLCIkZ3RlIiwiJGx0ZSIsIiRlcSIsIiRuZXEiLCJ0ZXh0RnVuY3Rpb25zIiwiJHRleHRGaW5kIiwic2VhcmNoIiwic2V0Iiwic3RhcnRJbmRleCIsIiR0ZXh0U2VhcmNoIiwiaXNRdWVyeU9iamVjdCIsIml0ZW0iLCJ1bmRlZmluZWQiLCJpc1F1ZXJ5T2JqZWN0QXJyYXkiLCJhcnIiLCJldmVyeSIsInYiLCJpc1N0cmluZ0FycmF5IiwiaXNTdHJpbmdPckZpZWxkTmFtZU9iamVjdCIsIiRmaWVsZE5hbWUiLCJhbGxJbmRleGVzVmFsaWQiLCJlIiwiaXNCYXNlRmllbGQiLCJhcmciLCJGdW5jdGlvbiIsImEiLCJ0cmltIiwidmFscyIsInZhbHVlcyIsImtleSIsImlzVGV4dEFyZ3MiLCJ2YWxLZXlzIiwic3ViVmFscyIsInZhbEtleSIsInN1YlZhbCIsIm9wdHMiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJwYXJhbXMiLCJvcHQiLCJmb3JtYXR0ZWQiLCJqIiwic3ViS2V5IiwiZW5jb2RlVVJJIiwic3RhdHVzIiwibmFtZSIsInR5cGUiLCJyZXF1aXJlZCIsInVybCIsInJldHJ5VGltZW91dCIsIm1heFJldHJ5IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZXRyeVJhdGVMaW1pdCIsInNldFRpbWVvdXQiLCJyZXMiLCJkYXRhIiwianNvbiIsImVyciIsInZhbGlkT3B0aW9ucyIsIkFzeW5jQWlydGFibGUiLCJhcGlLZXkiLCJiYXNlIiwiY29uZmlnIiwic2VsZWN0IiwidGFibGUiLCJvcHRpb25zIiwicGFnZSIsImNoZWNrQXJnIiwidGhpcyIsImJhc2VVUkwiLCJmb3JFYWNoIiwib3B0aW9uIiwib2Zmc2V0IiwiYnVpbGRPcHRzIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJib2R5IiwiY2hlY2tFcnJvciIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZXRyeU9uUmF0ZUxpbWl0IiwicmF0ZUxpbWl0SGFuZGxlciIsInJlY29yZHMiLCJkb25lIiwiY29uY2F0IiwiZmluZCIsImlkIiwiY3JlYXRlUmVjb3JkIiwicmVjb3JkIiwidHlwZWNhc3QiLCJmaWVsZHMiLCJtZXRob2QiLCJ1cGRhdGVSZWNvcmQiLCJkZXN0cnVjdGl2ZSIsImRlbGV0ZVJlY29yZCIsImJ1bGtDcmVhdGUiLCJidWxrVXBkYXRlIiwiYnVsa0RlbGV0ZSIsImlkcyIsInF1ZXJ5IiwidXBzZXJ0UmVjb3JkIiwiZmlsdGVyU3RyaW5nIiwiZXhpc3RzIiwiZmlsdGVyQnlGb3JtdWxhIl0sIm1hcHBpbmdzIjoic0NBR0EsSUFVSUEsRUFWWSxXQUlmLEdBQW9CLG9CQUFUQyxLQUF3QixPQUFPQSxLQUMxQyxHQUFzQixvQkFBWEMsT0FBMEIsT0FBT0EsT0FDNUMsUUFBc0IsSUFBWEYsRUFBMEIsT0FBT0EsRUFDNUMsTUFBTSxJQUFJRyxNQUFNLGtDQUdKQyxHQUViQyxFQUFPQyxRQUFVQSxFQUFVTixFQUFPTyxNQUc5QlAsRUFBT08s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TSxNQUFNLElBQUlsSCxNQUFNLHdCQUMzQnlILEtBQUtSLE9BQVNBLEVBQ2RRLEtBQUtQLEtBQU9BLEVBQ1pPLEtBQUtZLGtCQUFtQmxCLGFBQU0sRUFBTkEsRUFBUWtCLG9CQUFvQixFQUNwRFosS0FBS3JCLGNBQWVlLGFBQU0sRUFBTkEsRUFBUWYsZUFBZ0IsSUFDNUNxQixLQUFLcEIsVUFBV2MsYUFBTSxFQUFOQSxFQUFRZCxXQUFZLElBQ3BDb0IsS0FBS0MsU0FBVVAsYUFBTSxFQUFOQSxFQUFRTyxVQUFXLGtDIiwiZmlsZSI6ImFzeW5jQWlydGFibGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vIHJlZjogaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtZ2xvYmFsXG52YXIgZ2V0R2xvYmFsID0gZnVuY3Rpb24gKCkge1xuXHQvLyB0aGUgb25seSByZWxpYWJsZSBtZWFucyB0byBnZXQgdGhlIGdsb2JhbCBvYmplY3QgaXNcblx0Ly8gYEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKClgXG5cdC8vIEhvd2V2ZXIsIHRoaXMgY2F1c2VzIENTUCB2aW9sYXRpb25zIGluIENocm9tZSBhcHBzLlxuXHRpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7IHJldHVybiBzZWxmOyB9XG5cdGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykgeyByZXR1cm4gd2luZG93OyB9XG5cdGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykgeyByZXR1cm4gZ2xvYmFsOyB9XG5cdHRocm93IG5ldyBFcnJvcigndW5hYmxlIHRvIGxvY2F0ZSBnbG9iYWwgb2JqZWN0Jyk7XG59XG5cbnZhciBnbG9iYWwgPSBnZXRHbG9iYWwoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzID0gZ2xvYmFsLmZldGNoO1xuXG4vLyBOZWVkZWQgZm9yIFR5cGVTY3JpcHQgYW5kIFdlYnBhY2suXG5pZiAoZ2xvYmFsLmZldGNoKSB7XG5cdGV4cG9ydHMuZGVmYXVsdCA9IGdsb2JhbC5mZXRjaC5iaW5kKGdsb2JhbCk7XG59XG5cbmV4cG9ydHMuSGVhZGVycyA9IGdsb2JhbC5IZWFkZXJzO1xuZXhwb3J0cy5SZXF1ZXN0ID0gZ2xvYmFsLlJlcXVlc3Q7XG5leHBvcnRzLlJlc3BvbnNlID0gZ2xvYmFsLlJlc3BvbnNlOyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdGlmKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0pIHtcblx0XHRyZXR1cm4gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiaW1wb3J0ICogYXMgbm9kZUZldGNoIGZyb20gJ25vZGUtZmV0Y2gnO1xuZXhwb3J0IGRlZmF1bHQgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgPyB3aW5kb3cuZmV0Y2guYmluZCh3aW5kb3cpXG4gIDogKChub2RlRmV0Y2ggYXMgdW5rbm93bikgYXMgdHlwZW9mIGZldGNoKTtcbiIsImltcG9ydCB7IEFycmF5RnVuY3Rpb25zIH0gZnJvbSAnLi9AdHlwZXMnO1xuXG5leHBvcnQgY29uc3QgYXJyYXlGdW5jdGlvbnM6IEFycmF5RnVuY3Rpb25zID0ge1xuICAkYXJyYXlDb21wYWN0OiAoZmllbGROYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIHJldHVybiBgQVJSQVlDT01QQUNUKHske2ZpZWxkTmFtZX19KWA7XG4gIH0sXG4gICRhcnJheUZsYXR0ZW46IChmaWVsZE5hbWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gICAgcmV0dXJuIGBBUlJBWUZMQVRURU4oeyR7ZmllbGROYW1lfX0pYDtcbiAgfSxcbiAgJGFycmF5VW5pcXVlOiAoZmllbGROYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIHJldHVybiBgQVJSQVlVTklRVUUoeyR7ZmllbGROYW1lfX0pYDtcbiAgfSxcbiAgJGFycmF5Sm9pbjogKGZpZWxkTmFtZTogc3RyaW5nLCBzZXBlcmF0b3IgPSAnLCcpOiBzdHJpbmcgPT4ge1xuICAgIHJldHVybiBgQVJSQVlKT0lOKHske2ZpZWxkTmFtZX19LCAnJHtzZXBlcmF0b3J9JylgO1xuICB9LFxufTtcbiIsImltcG9ydCB7IEJhc2VGaWVsZFR5cGUgfSBmcm9tICcuL0B0eXBlcyc7XG5cbmV4cG9ydCBjb25zdCBib29sZWFuSGFuZGxlciA9IChib29sOiBib29sZWFuKTogc3RyaW5nID0+IHtcbiAgaWYgKHR5cGVvZiBib29sICE9PSAnYm9vbGVhbicpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdHlwZScpO1xuICB9XG4gIHJldHVybiBib29sID8gJ1RSVUUoKScgOiAnRkFMU0UoKSc7XG59O1xuXG5leHBvcnQgY29uc3QgYmFzZUhhbmRsZXIgPSAodmFsOiBCYXNlRmllbGRUeXBlKTogc3RyaW5nID0+IHtcbiAgaWYgKHZhbCA9PT0gbnVsbCkge1xuICAgIHJldHVybiAnQkxBTksoKSc7XG4gIH1cbiAgc3dpdGNoICh0eXBlb2YgdmFsKSB7XG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgIHJldHVybiBgJHt2YWx9YDtcbiAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgcmV0dXJuIGAnJHt2YWx9J2A7XG4gICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICByZXR1cm4gYm9vbGVhbkhhbmRsZXIodmFsKTtcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBUeXBlJyk7XG4gIH1cbn07XG4iLCJpbXBvcnQgeyBMb2dpY2FsRnVuY3Rpb25zLCBRdWVyeU9iamVjdCB9IGZyb20gJy4vQHR5cGVzJztcbmltcG9ydCB7IHF1ZXJ5QnVpbGRlciB9IGZyb20gJy4vcXVlcnlCdWlsZGVyJztcblxuZXhwb3J0IGNvbnN0IGxvZ2ljYWxGdW5jdGlvbnM6IExvZ2ljYWxGdW5jdGlvbnMgPSB7XG4gICRub3Q6IChleHByZXNzaW9uOiBRdWVyeU9iamVjdCkgPT4gYE5PVCgke3F1ZXJ5QnVpbGRlcihleHByZXNzaW9uKX0pYCxcbiAgJGFuZDogKGFyZ3M6IFF1ZXJ5T2JqZWN0W10pID0+IGBBTkQoJHtxdWVyeUJ1aWxkZXIoYXJncyl9KWAsXG4gICRvcjogKGFyZ3M6IFF1ZXJ5T2JqZWN0W10pID0+IGBPUigke3F1ZXJ5QnVpbGRlcihhcmdzKX0pYCxcbn07XG4iLCJpbXBvcnQgeyBDb21wYXJpc29uT2JqZWN0IH0gZnJvbSAnLi9AdHlwZXMnO1xuaW1wb3J0IHsgcXVlcnlCdWlsZGVyIH0gZnJvbSAnLi9xdWVyeUJ1aWxkZXInO1xuXG5jb25zdCBvcGVyYXRvcnMgPSBbJz0nLCAnIT0nLCAnPicsICc+PScsICc8JywgJzw9J107XG5cbmV4cG9ydCBjb25zdCBidWlsZEV4cHJlc3Npb24gPSAob2JqOiBDb21wYXJpc29uT2JqZWN0LCBvcDogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnIHx8IEFycmF5LmlzQXJyYXkob2JqKSlcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb3IgSW52YWxpZCBDb21wYXJpc29uIE9iamVjdCcpO1xuICBpZiAodHlwZW9mIG9wICE9PSAnc3RyaW5nJyAmJiAhb3BlcmF0b3JzLmluY2x1ZGVzKG9wKSlcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb3IgSW52YWxpZCBDb21wYXJpc29uIE9wZXJhdG9yJyk7XG4gIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhvYmopO1xuICBjb25zdCBleHByZXNzaW9uTWFwcGVyID0gKGs6IHN0cmluZywgaTogbnVtYmVyKSA9PiB7XG4gICAgY29uc3QgdmFsID0gcXVlcnlCdWlsZGVyKG9ialtrXSk7XG4gICAgcmV0dXJuIGB7JHtrfX0gJHtvcH0gJHt2YWx9JHtpIDwga2V5cy5sZW5ndGggLSAxID8gJywgJyA6ICcnfWA7XG4gIH07XG5cbiAgY29uc3QgZXhwID0gYCR7a2V5cy5tYXAoZXhwcmVzc2lvbk1hcHBlcikuam9pbignJyl9YDtcbiAgcmV0dXJuIGtleXMubGVuZ3RoID4gMSA/IGBBTkQoJHtleHB9KWAgOiBleHA7XG59O1xuIiwiaW1wb3J0IHsgTG9naWNhbE9wZXJhdG9ycyB9IGZyb20gJy4vQHR5cGVzJztcbmltcG9ydCB7IGJ1aWxkRXhwcmVzc2lvbiB9IGZyb20gJy4vYnVpbGRFeHByZXNzaW9uJztcblxuZXhwb3J0IGNvbnN0IGxvZ2ljYWxPcGVyYXRvcnM6IExvZ2ljYWxPcGVyYXRvcnMgPSB7XG4gICRndDogKHZhbCkgPT4ge1xuICAgIHJldHVybiBidWlsZEV4cHJlc3Npb24odmFsLCAnPicpO1xuICB9LFxuICAkbHQ6ICh2YWwpID0+IHtcbiAgICByZXR1cm4gYnVpbGRFeHByZXNzaW9uKHZhbCwgJzwnKTtcbiAgfSxcbiAgJGd0ZTogKHZhbCkgPT4ge1xuICAgIHJldHVybiBidWlsZEV4cHJlc3Npb24odmFsLCAnPj0nKTtcbiAgfSxcbiAgJGx0ZTogKHZhbCkgPT4ge1xuICAgIHJldHVybiBidWlsZEV4cHJlc3Npb24odmFsLCAnPD0nKTtcbiAgfSxcbiAgJGVxOiAodmFsKSA9PiB7XG4gICAgcmV0dXJuIGJ1aWxkRXhwcmVzc2lvbih2YWwsICc9Jyk7XG4gIH0sXG4gICRuZXE6ICh2YWwpID0+IHtcbiAgICByZXR1cm4gYnVpbGRFeHByZXNzaW9uKHZhbCwgJyE9Jyk7XG4gIH0sXG59O1xuIiwiaW1wb3J0IHsgRmllbGROYW1lT2JqZWN0LCBRdWVyeU9iamVjdCwgVGV4dEZ1bmN0aW9ucyB9IGZyb20gJy4vQHR5cGVzJztcbmltcG9ydCB7IGJhc2VIYW5kbGVyIH0gZnJvbSAnLi9iYXNlSGFuZGxlcnMnO1xuaW1wb3J0IHsgcXVlcnlCdWlsZGVyIH0gZnJvbSAnLi9xdWVyeUJ1aWxkZXInO1xuXG5leHBvcnQgY29uc3QgdGV4dEZ1bmN0aW9uczogVGV4dEZ1bmN0aW9ucyA9IHtcbiAgJHRleHRGaW5kOiAoXG4gICAgc2VhcmNoOiBGaWVsZE5hbWVPYmplY3QgfCBzdHJpbmcgfCBRdWVyeU9iamVjdCxcbiAgICBzZXQ6IEZpZWxkTmFtZU9iamVjdCB8IHN0cmluZyB8IFF1ZXJ5T2JqZWN0LFxuICAgIHN0YXJ0SW5kZXggPSAwLFxuICApOiBzdHJpbmcgPT5cbiAgICBgRklORCgke1xuICAgICAgdHlwZW9mIHNlYXJjaCA9PT0gJ3N0cmluZycgPyBiYXNlSGFuZGxlcihzZWFyY2gpIDogcXVlcnlCdWlsZGVyKHNlYXJjaClcbiAgICB9LCAke1xuICAgICAgdHlwZW9mIHNldCA9PT0gJ3N0cmluZycgPyBiYXNlSGFuZGxlcihzZXQpIDogcXVlcnlCdWlsZGVyKHNldClcbiAgICB9LCAke3N0YXJ0SW5kZXh9KWAsXG4gICR0ZXh0U2VhcmNoOiAoXG4gICAgc2VhcmNoOiBGaWVsZE5hbWVPYmplY3QgfCBzdHJpbmcgfCBRdWVyeU9iamVjdCxcbiAgICBzZXQ6IEZpZWxkTmFtZU9iamVjdCB8IHN0cmluZyB8IFF1ZXJ5T2JqZWN0LFxuICAgIHN0YXJ0SW5kZXggPSAwLFxuICApOiBzdHJpbmcgPT5cbiAgICBgU0VBUkNIKCR7XG4gICAgICB0eXBlb2Ygc2VhcmNoID09PSAnc3RyaW5nJyA/IGJhc2VIYW5kbGVyKHNlYXJjaCkgOiBxdWVyeUJ1aWxkZXIoc2VhcmNoKVxuICAgIH0sICR7XG4gICAgICB0eXBlb2Ygc2V0ID09PSAnc3RyaW5nJyA/IGJhc2VIYW5kbGVyKHNldCkgOiBxdWVyeUJ1aWxkZXIoc2V0KVxuICAgIH0sICR7c3RhcnRJbmRleH0pYCxcbn07XG4iLCJpbXBvcnQge1xuICBRdWVyeU9iamVjdCxcbiAgUXVlcnlGaWVsZCxcbiAgSm9pbkFyZ3MsXG4gIFRleHRBcmdzLFxuICBGaWVsZE5hbWVPYmplY3QsXG4gIFVuY2hlY2tlZEFycmF5LFxuICBCYXNlRmllbGRUeXBlLFxufSBmcm9tICcuL0B0eXBlcyc7XG5cbmV4cG9ydCBjb25zdCBpc1F1ZXJ5T2JqZWN0ID0gKGl0ZW06IFF1ZXJ5RmllbGQpOiBpdGVtIGlzIFF1ZXJ5T2JqZWN0ID0+IHtcbiAgaWYgKGl0ZW0gPT09IHVuZGVmaW5lZCkgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIFF1ZXJ5IE9iamVjdCcpO1xuICByZXR1cm4gaXRlbSAhPT0gbnVsbCAmJiBpdGVtIGluc3RhbmNlb2YgT2JqZWN0ICYmICFBcnJheS5pc0FycmF5KGl0ZW0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGlzUXVlcnlPYmplY3RBcnJheSA9IChhcnI6IFF1ZXJ5RmllbGQpOiBhcnIgaXMgUXVlcnlPYmplY3RbXSA9PlxuICBhcnIgaW5zdGFuY2VvZiBBcnJheSAmJiBhcnIuZXZlcnkoKHY6IFF1ZXJ5RmllbGQpID0+IGlzUXVlcnlPYmplY3QodikpO1xuXG5leHBvcnQgY29uc3QgaXNTdHJpbmdBcnJheSA9IChhcnI6IFF1ZXJ5RmllbGQpOiBhcnIgaXMgc3RyaW5nW10gPT5cbiAgYXJyIGluc3RhbmNlb2YgQXJyYXkgJiYgYXJyLmV2ZXJ5KCh2OiBRdWVyeUZpZWxkKSA9PiB0eXBlb2YgdiA9PT0gJ3N0cmluZycpO1xuXG5leHBvcnQgY29uc3QgaXNKb2luQXJncyA9IChhcnI6IHN0cmluZ1tdKTogYXJyIGlzIEpvaW5BcmdzID0+XG4gIGlzU3RyaW5nQXJyYXkoYXJyKSAmJiBhcnIubGVuZ3RoID09PSAyO1xuXG5leHBvcnQgY29uc3QgaXNTdHJpbmdPckZpZWxkTmFtZU9iamVjdCA9IChcbiAgdmFsOiBRdWVyeUZpZWxkLFxuKTogdmFsIGlzIHN0cmluZyB8IEZpZWxkTmFtZU9iamVjdCA9PlxuICB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyB8fFxuICAodmFsIGluc3RhbmNlb2YgT2JqZWN0ICYmXG4gICAgIUFycmF5LmlzQXJyYXkodmFsKSAmJlxuICAgIHR5cGVvZiB2YWw/LiRmaWVsZE5hbWUgPT09ICdzdHJpbmcnKTtcblxuZXhwb3J0IGNvbnN0IGlzVGV4dEFyZ3MgPSAoYXJyOiBRdWVyeUZpZWxkW10pOiBhcnIgaXMgVGV4dEFyZ3MgPT5cbiAgYXJyIGluc3RhbmNlb2YgQXJyYXkgJiZcbiAgKChhcnIubGVuZ3RoID09PSAzICYmIHR5cGVvZiBhcnJbMl0gPT09ICdudW1iZXInKSB8fFxuICAgIChhcnIubGVuZ3RoID09PSAyICYmXG4gICAgICAoaXNTdHJpbmdPckZpZWxkTmFtZU9iamVjdChhcnJbMF0pIHx8IGlzUXVlcnlPYmplY3QoYXJyWzBdKSkgJiZcbiAgICAgIChpc1N0cmluZ09yRmllbGROYW1lT2JqZWN0KGFyclsxXSkgfHwgaXNRdWVyeU9iamVjdChhcnJbMV0pKSkpO1xuXG5leHBvcnQgY29uc3QgYWxsSW5kZXhlc1ZhbGlkID0gKGFycjogVW5jaGVja2VkQXJyYXkpOiBhcnIgaXMgUXVlcnlGaWVsZFtdID0+XG4gIGFyci5ldmVyeSgoZSkgPT4gZSAhPT0gdW5kZWZpbmVkICYmIGUgIT09IG51bGwpO1xuXG5leHBvcnQgY29uc3QgaXNCYXNlRmllbGQgPSAoaXRlbTogUXVlcnlGaWVsZCk6IGl0ZW0gaXMgQmFzZUZpZWxkVHlwZSA9PlxuICB0eXBlb2YgaXRlbSAhPT0gJ29iamVjdCcgfHwgaXRlbSA9PT0gbnVsbDtcbiIsImltcG9ydCB7IFF1ZXJ5RmllbGQsIFF1ZXJ5T2JqZWN0IH0gZnJvbSAnLi9AdHlwZXMnO1xuaW1wb3J0IHsgYXJyYXlGdW5jdGlvbnMgfSBmcm9tICcuL2FycmF5RnVuY3Rpb25zJztcbmltcG9ydCB7IGJhc2VIYW5kbGVyIH0gZnJvbSAnLi9iYXNlSGFuZGxlcnMnO1xuaW1wb3J0IHsgbG9naWNhbEZ1bmN0aW9ucyB9IGZyb20gJy4vbG9naWNhbEZ1bmN0aW9ucyc7XG5pbXBvcnQgeyBsb2dpY2FsT3BlcmF0b3JzIH0gZnJvbSAnLi9sb2dpY2FsT3BlcmF0b3JzJztcbmltcG9ydCB7IHRleHRGdW5jdGlvbnMgfSBmcm9tICcuL3RleHRGdW5jdGlvbnMnO1xuaW1wb3J0IHtcbiAgYWxsSW5kZXhlc1ZhbGlkLFxuICBpc0Jhc2VGaWVsZCxcbiAgaXNKb2luQXJncyxcbiAgaXNRdWVyeU9iamVjdCxcbiAgaXNRdWVyeU9iamVjdEFycmF5LFxuICBpc1N0cmluZ0FycmF5LFxuICBpc1RleHRBcmdzLFxufSBmcm9tICcuL3R5cGVDaGVja2Vycyc7XG5cbmV4cG9ydCBjb25zdCBxdWVyeUJ1aWxkZXIgPSAoYXJnOiBRdWVyeUZpZWxkKTogc3RyaW5nID0+IHtcbiAgaWYgKGFyZyAhPT0gdW5kZWZpbmVkICYmICEoYXJnIGluc3RhbmNlb2YgRnVuY3Rpb24pKSB7XG4gICAgaWYgKGlzQmFzZUZpZWxkKGFyZykpIHtcbiAgICAgIHJldHVybiBiYXNlSGFuZGxlcihhcmcpO1xuICAgIH1cblxuICAgIGlmIChhcmcgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgY29uc3Qgc3RyID0gYXJnLm1hcCgoYTogUXVlcnlGaWVsZCkgPT4gcXVlcnlCdWlsZGVyKGEpKS5qb2luKCcsICcpO1xuICAgICAgcmV0dXJuIHN0ci50cmltKCk7XG4gICAgfVxuXG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGFyZyk7XG4gICAgY29uc3QgdmFscyA9IE9iamVjdC52YWx1ZXMoYXJnKTtcblxuICAgIGlmIChcbiAgICAgIGtleXMubGVuZ3RoID4gMSAmJlxuICAgICAgYWxsSW5kZXhlc1ZhbGlkKHZhbHMpICYmXG4gICAgICBpc1F1ZXJ5T2JqZWN0QXJyYXkoa2V5cy5tYXAoKGssIGkpID0+ICh7IFtrXTogdmFsc1tpXSB9KSkpXG4gICAgKSB7XG4gICAgICByZXR1cm4gbG9naWNhbEZ1bmN0aW9ucy4kYW5kKFxuICAgICAgICBrZXlzLm1hcCgoaywgaSkgPT4gKHsgW2tdOiB2YWxzW2ldIH0pKSBhcyBRdWVyeU9iamVjdCAmIFF1ZXJ5T2JqZWN0W10sXG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IGtleSA9IGtleXNbMF07XG5cbiAgICBpZiAoYXJnW2tleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHF1ZXJ5Jyk7XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PT0gJyRmaWVsZE5hbWUnKSB7XG4gICAgICByZXR1cm4gYHske2FyZy4kZmllbGROYW1lfX1gO1xuICAgIH1cblxuICAgIGNvbnN0IHZhbCA9IGFyZ1trZXldIGFzIFF1ZXJ5RmllbGQ7XG4gICAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoXG4gICAgICAgIGtleSBpbiBsb2dpY2FsRnVuY3Rpb25zICYmXG4gICAgICAgIChpc1F1ZXJ5T2JqZWN0KHZhbCkgfHwgaXNRdWVyeU9iamVjdEFycmF5KHZhbCkpXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIGxvZ2ljYWxGdW5jdGlvbnNba2V5XSh2YWwgYXMgUXVlcnlPYmplY3QgJiBRdWVyeU9iamVjdFtdKTtcbiAgICAgIH0gZWxzZSBpZiAoa2V5IGluIGFycmF5RnVuY3Rpb25zKSB7XG4gICAgICAgIGlmIChpc1N0cmluZ0FycmF5KHZhbCkgJiYgaXNKb2luQXJncyh2YWwpKSB7XG4gICAgICAgICAgcmV0dXJuIGFycmF5RnVuY3Rpb25zW2tleV0oLi4udmFsKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHJldHVybiBhcnJheUZ1bmN0aW9uc1trZXldKHZhbCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgIGtleSBpbiB0ZXh0RnVuY3Rpb25zICYmXG4gICAgICAgIEFycmF5LmlzQXJyYXkodmFsKSAmJlxuICAgICAgICBpc1RleHRBcmdzKHZhbClcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gdGV4dEZ1bmN0aW9uc1trZXldKHZhbFswXSwgdmFsWzFdLCB2YWxbMl0gPz8gMCk7XG4gICAgICB9IGVsc2UgaWYgKGlzUXVlcnlPYmplY3QodmFsKSkge1xuICAgICAgICBjb25zdCB2YWxLZXlzID0gT2JqZWN0LmtleXModmFsKTtcbiAgICAgICAgY29uc3Qgc3ViVmFscyA9IE9iamVjdC52YWx1ZXModmFsKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgdmFsS2V5cy5sZW5ndGggPiAxICYmXG4gICAgICAgICAgYWxsSW5kZXhlc1ZhbGlkKHN1YlZhbHMpICYmXG4gICAgICAgICAgaXNRdWVyeU9iamVjdEFycmF5KHZhbEtleXMubWFwKChrLCBpKSA9PiAoeyBba106IHN1YlZhbHNbaV0gfSkpKSAmJlxuICAgICAgICAgIHZhbEtleXMuZXZlcnkoKGspID0+IGsgaW4gbG9naWNhbE9wZXJhdG9ycykgJiZcbiAgICAgICAgICBzdWJWYWxzLmV2ZXJ5KCh2KSA9PiBpc1F1ZXJ5T2JqZWN0KHYpIHx8IGlzQmFzZUZpZWxkKHYpKVxuICAgICAgICApIHtcbiAgICAgICAgICByZXR1cm4gbG9naWNhbEZ1bmN0aW9ucy4kYW5kKFxuICAgICAgICAgICAgdmFsS2V5cy5tYXAoKGssIGkpID0+ICh7XG4gICAgICAgICAgICAgIFtrZXldOiB7IFtrXTogc3ViVmFsc1tpXSB9LFxuICAgICAgICAgICAgfSkpIGFzIFF1ZXJ5T2JqZWN0ICYgUXVlcnlPYmplY3RbXSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdmFsS2V5ID0gdmFsS2V5c1swXTtcbiAgICAgICAgY29uc3Qgc3ViVmFsID0gc3ViVmFsc1swXTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIHZhbEtleSBpbiBsb2dpY2FsT3BlcmF0b3JzICYmXG4gICAgICAgICAgKGlzUXVlcnlPYmplY3Qoc3ViVmFsKSB8fCBpc0Jhc2VGaWVsZChzdWJWYWwpKVxuICAgICAgICApIHtcbiAgICAgICAgICByZXR1cm4gbG9naWNhbE9wZXJhdG9yc1t2YWxLZXldKHtcbiAgICAgICAgICAgIFtrZXldOiBzdWJWYWwsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoaXNRdWVyeU9iamVjdCh2YWwpIHx8IGlzQmFzZUZpZWxkKHZhbCkpIHtcbiAgICAgICAgcmV0dXJuIGxvZ2ljYWxPcGVyYXRvcnMuJGVxKHsgW2tleV06IHZhbCB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIFF1ZXJ5IE9iamVjdCcpO1xufTtcbiIsImltcG9ydCB7IFNlbGVjdE9wdGlvbnMgfSBmcm9tICcuL0B0eXBlcyc7XG5pbXBvcnQgeyBxdWVyeUJ1aWxkZXIgfSBmcm9tICcuL3F1ZXJ5QnVpbGRlcic7XG5cbmV4cG9ydCBkZWZhdWx0IChvcHRzOiBTZWxlY3RPcHRpb25zKTogc3RyaW5nID0+IHtcbiAgaWYgKFxuICAgIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvcHRzLCAnZmlsdGVyQnlGb3JtdWxhJykgJiZcbiAgICBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob3B0cywgJ3doZXJlJylcbiAgKVxuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdDYW5ub3QgdXNlIGJvdGggd2hlcmUgYW5kIGZpbHRlckJ5Rm9ybXVsYSBhcyB0aGV5IGFjY29tcGxpc2ggdGhlIHNhbWUgdGhpbmcnLFxuICAgICk7XG5cbiAgY29uc3QgcGFyYW1zID0gT2JqZWN0LmtleXMob3B0cylcbiAgICAubWFwKChrZXk6IHN0cmluZywgaSkgPT4ge1xuICAgICAgLyoqIEB0b2RvIEZpbmQgYSBiZXR0ZXIgdHlwZSB0aGFuIGFueSBmb3IgdGhpcyAqL1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgIGNvbnN0IG9wdDogYW55ID0gb3B0c1trZXkgYXMga2V5b2YgU2VsZWN0T3B0aW9uc107XG4gICAgICBsZXQgZm9ybWF0dGVkO1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkob3B0KSkge1xuICAgICAgICBmb3JtYXR0ZWQgPSBvcHRcbiAgICAgICAgICAubWFwKChpdGVtLCBqKSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGVvZiBpdGVtKSB7XG4gICAgICAgICAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGl0ZW0pXG4gICAgICAgICAgICAgICAgICAubWFwKChzdWJLZXkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAke2tleX1bJHtqfV1bJHtzdWJLZXl9XT0ke2l0ZW1bc3ViS2V5XX1gO1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIC5qb2luKCcmJyk7XG4gICAgICAgICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke2tleX1bXT0ke2l0ZW19YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICAgIC5qb2luKCcmJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoa2V5ID09PSAnd2hlcmUnKSB7XG4gICAgICAgICAgZm9ybWF0dGVkID0gYGZpbHRlckJ5Rm9ybXVsYT0ke3F1ZXJ5QnVpbGRlcihvcHQpfWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9ybWF0dGVkID0gYCR7a2V5fT0ke29wdH1gO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gaSAhPT0gMCA/IGAmJHtmb3JtYXR0ZWR9YCA6IGZvcm1hdHRlZDtcbiAgICB9KVxuICAgIC5qb2luKCcnKTtcbiAgcmV0dXJuIGVuY29kZVVSSShwYXJhbXMpO1xufTtcbiIsImV4cG9ydCBkZWZhdWx0IChzdGF0dXM6IG51bWJlcik6IGJvb2xlYW4gPT4gc3RhdHVzID49IDMwMDtcbiIsImltcG9ydCB7IEFyZyB9IGZyb20gJy4vQHR5cGVzJztcblxuZXhwb3J0IGRlZmF1bHQgKFxuICBhcmc6IEFyZyxcbiAgbmFtZTogc3RyaW5nLFxuICB0eXBlOiBzdHJpbmcsXG4gIHJlcXVpcmVkID0gdHJ1ZSxcbik6IHZvaWQgPT4ge1xuICBpZiAoYXJnID09PSB1bmRlZmluZWQgJiYgcmVxdWlyZWQpXG4gICAgdGhyb3cgbmV3IEVycm9yKGBBcmd1bWVudCBcIiR7bmFtZX1cIiBpcyByZXF1aXJlZC5gKTtcbiAgaWYgKGFyZyA9PT0gdW5kZWZpbmVkICYmICFyZXF1aXJlZCkgcmV0dXJuO1xuICBpZiAodHlwZW9mIGFyZyAhPT0gdHlwZSkge1xuICAgIGlmICh0eXBlID09PSAnYXJyYXknICYmIEFycmF5LmlzQXJyYXkoYXJnKSkgcmV0dXJuO1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBJbmNvcnJlY3QgZGF0YSB0eXBlIG9uIGFyZ3VtZW50IFwiJHtuYW1lfVwiLiBSZWNlaXZlZCBcIiR7dHlwZW9mIGFyZ31cIjogZXhwZWN0ZWQgXCIke3R5cGV9XCJgLFxuICAgICk7XG4gIH1cbn07XG4iLCJpbXBvcnQgZmV0Y2ggZnJvbSAnLi9mZXRjaCc7XG5leHBvcnQgZGVmYXVsdCBhc3luYyAoXG4gIHVybDogc3RyaW5nLFxuICBvcHRzOiBSZXF1ZXN0SW5pdCxcbiAgcmV0cnlUaW1lb3V0OiBudW1iZXIsXG4gIG1heFJldHJ5OiBudW1iZXIsXG4gIGtleT86IHN0cmluZyxcbiAgLyoqIEB0b2RvIEZpbmQgYSBiZXR0ZXIgdHlwZSB0aGFuIGFueSBmb3IgdGhpcyAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuKTogUHJvbWlzZTxhbnk+ID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCByZXRyeVJhdGVMaW1pdCA9IChcbiAgICAgIHVybDogc3RyaW5nLFxuICAgICAgb3B0czogUmVxdWVzdEluaXQsXG4gICAgICByZXRyeVRpbWVvdXQ6IG51bWJlcixcbiAgICAgIG1heFJldHJ5OiBudW1iZXIsXG4gICAgICBrZXk/OiBzdHJpbmcsXG4gICAgKTogdm9pZCA9PiB7XG4gICAgICBpZiAobWF4UmV0cnkgJiYgbWF4UmV0cnkgPCAxKSB7XG4gICAgICAgIHJlamVjdCgnTWF4IHRpbWVvdXQgZXhjZWVkZWQnKTtcbiAgICAgIH1cbiAgICAgIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybCwgb3B0cyk7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDQyOSkge1xuICAgICAgICAgICAgcmV0dXJuIHJldHJ5UmF0ZUxpbWl0KFxuICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgIG9wdHMsXG4gICAgICAgICAgICAgIHJldHJ5VGltZW91dCAqIDEuNSxcbiAgICAgICAgICAgICAgbWF4UmV0cnkgLSByZXRyeVRpbWVvdXQsXG4gICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICAgIHJlc29sdmUoZGF0YVtrZXldKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG4gICAgICB9LCByZXRyeVRpbWVvdXQpO1xuICAgIH07XG5cbiAgICByZXRyeVJhdGVMaW1pdCh1cmwsIG9wdHMsIHJldHJ5VGltZW91dCwgbWF4UmV0cnksIGtleSk7XG4gIH0pO1xufTtcbiIsImltcG9ydCBmZXRjaCBmcm9tICcuL2ZldGNoJztcbmltcG9ydCBidWlsZE9wdHMgZnJvbSAnLi9idWlsZE9wdHMnO1xuaW1wb3J0IGNoZWNrRXJyb3IgZnJvbSAnLi9jaGVja0Vycm9yJztcbmltcG9ydCBjaGVja0FyZyBmcm9tICcuL2NoZWNrQXJnJztcbmltcG9ydCByYXRlTGltaXRIYW5kbGVyIGZyb20gJy4vcmF0ZUxpbWl0SGFuZGxlcic7XG5pbXBvcnQge1xuICBTZWxlY3RPcHRpb25zLFxuICBBaXJ0YWJsZURlbGV0ZWRSZXNwb25zZSxcbiAgQWlydGFibGVSZWNvcmQsXG4gIEFpcnRhYmxlUmVjb3JkUmVzcG9uc2UsXG4gIEFpcnRhYmxlVXBkYXRlUmVjb3JkLFxuICBEZWxldGVSZXNwb25zZSxcbiAgRmllbGRzLFxuICBDb25maWcsXG4gIHF1ZXJ5Qm9keSxcbiAgVHlwZWNhc3QsXG4gIHVwZGF0ZU9wdHMsXG4gIGJ1bGtRdWVyeUJvZHksXG59IGZyb20gJy4vQHR5cGVzJztcblxuLyoqIEBpZ25vcmUgKi9cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgQXN5bmNBaXJ0YWJsZTogdHlwZW9mIEFzeW5jQWlydGFibGU7XG4gIH1cbn1cblxuY29uc3QgdmFsaWRPcHRpb25zOiBzdHJpbmdbXSA9IFtcbiAgJ2ZpZWxkcycsXG4gICdmaWx0ZXJCeUZvcm11bGEnLFxuICAnbWF4UmVjb3JkcycsXG4gICdwYWdlU2l6ZScsXG4gICdzb3J0JyxcbiAgJ3ZpZXcnLFxuICAnd2hlcmUnLFxuXTtcblxuLyoqXG4gKiBUaGUgbWFpbiBBc3luY0FpcnRhYmxlIGNsYXNzLlxuICovXG5leHBvcnQgY2xhc3MgQXN5bmNBaXJ0YWJsZSB7XG4gIC8qKlxuICAgKiBAZGVmYXVsdD10cnVlXG4gICAqIFRoaXMgZGVjaWRlcyB3aGV0aGVyIG9yIG5vdCB0aGUgbGlicmFyeSB3aWxsXG4gICAqIGhhbmRsZSByZXRyeWluZyBhIHJlcXVlc3Qgd2hlbiByYXRlIGxpbWl0ZWRcbiAgICovXG4gIHJldHJ5T25SYXRlTGltaXQ6IGJvb2xlYW47XG4gIC8qKlxuICAgKiBAZGVmYXVsdD02MDAwMFxuICAgKiBUaGUgbWF4bWl1bSBhbW91bnQgb2YgdGltZSBiZWZvcmUgdGhlXG4gICAqIGxpYnJhcnkgd2lsbCBzdG9wIHJldHJ5aW5nIGFuZCB0aW1lb3V0IHdoZW4gcmF0ZSBsaW1pdGVkXG4gICAqL1xuICBtYXhSZXRyeTogbnVtYmVyO1xuICAvKipcbiAgICogQGRlZmF1bHQ9NTAwMFxuICAgKiBUaGUgc3RhcnRpbmcgdGltZW91dCBmb3IgdGhlIHJldHJ5LiBUaGlzIHdpbGwgZ2V0IDUwJVxuICAgKiBsYXJnZXIgd2l0aCBlYWNoIHRyeSB1bnRpbCB5b3UgaGl0IHRoZSBtYXhSZXRyeSBhbW91bnRcbiAgICovXG4gIHJldHJ5VGltZW91dDogbnVtYmVyO1xuICAvKiogVGhlIEFQSSBLZXkgZnJvbSBBaXJUYWJsZSAqL1xuICBhcGlLZXk6IHN0cmluZztcbiAgLyoqIFRoZSBiYXNlIGlkIGZyb20gQWlyVGFibGUgKi9cbiAgYmFzZTogc3RyaW5nO1xuICAvKiogdGhlIGJhc2UgVVJMIHRvIHVzZSB3aGVuIG1ha2luZyBBUEkgcmVxdWVzdHMgKi9cbiAgYmFzZVVSTDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBBc3luY0FpcnRhYmxlIGxpYnJhcnkuXG4gICAqIEBwYXJhbSBhcGlLZXkgVGhlIEFQSSBLZXkgZnJvbSBBaXJUYWJsZVxuICAgKiBAcGFyYW0gYmFzZSBUaGUgYmFzZSBpZCBmcm9tIEFpclRhYmxlXG4gICAqIEBwYXJhbSBjb25maWcgVGhlIGNvbmZpZyB0byB1c2UgZm9yIHRoaXMgaW5zdGFuY2Ugb2YgQXN5bmNBaXJ0YWJsZVxuICAgKi9cbiAgY29uc3RydWN0b3IoYXBpS2V5OiBzdHJpbmcsIGJhc2U6IHN0cmluZywgY29uZmlnPzogQ29uZmlnKSB7XG4gICAgaWYgKCFhcGlLZXkpIHRocm93IG5ldyBFcnJvcignQVBJIEtleSBpcyByZXF1aXJlZC4nKTtcbiAgICBpZiAoIWJhc2UpIHRocm93IG5ldyBFcnJvcignQmFzZSBJRCBpcyByZXF1aXJlZC4nKTtcbiAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICB0aGlzLmJhc2UgPSBiYXNlO1xuICAgIHRoaXMucmV0cnlPblJhdGVMaW1pdCA9IGNvbmZpZz8ucmV0cnlPblJhdGVMaW1pdCB8fCB0cnVlO1xuICAgIHRoaXMucmV0cnlUaW1lb3V0ID0gY29uZmlnPy5yZXRyeVRpbWVvdXQgfHwgNTAwMDtcbiAgICB0aGlzLm1heFJldHJ5ID0gY29uZmlnPy5tYXhSZXRyeSB8fCA2MDAwMDtcbiAgICB0aGlzLmJhc2VVUkwgPSBjb25maWc/LmJhc2VVUkwgfHwgJ2h0dHBzOi8vYXBpLmFpcnRhYmxlLmNvbS92MCc7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IHJlY29yZChzKSBmcm9tIHRoZSBzcGVjaWZpZWQgdGFibGUuXG4gICAqIEBwYXJhbSB0YWJsZSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbnMgb2JqZWN0LCB1c2VkIHRvIGZpbHRlciByZWNvcmRzXG4gICAqIEBwYXJhbSBwYWdlIFVzZWQgdG8gZ2V0IGEgc3BlY2lmaWMgcGFnZSBvZiByZWNvcmRzXG4gICAqIEByZXR1cm5zXG4gICAqIEBhc3luY1xuICAgKi9cbiAgc2VsZWN0ID0gYXN5bmMgKFxuICAgIHRhYmxlOiBzdHJpbmcsXG4gICAgb3B0aW9ucz86IFNlbGVjdE9wdGlvbnMsXG4gICAgcGFnZT86IG51bWJlcixcbiAgKTogUHJvbWlzZTxBaXJ0YWJsZVJlY29yZFtdPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrQXJnKHRhYmxlLCAndGFibGUnLCAnc3RyaW5nJyk7XG4gICAgICBjaGVja0FyZyhvcHRpb25zLCAnb3B0aW9ucycsICdvYmplY3QnLCBmYWxzZSk7XG4gICAgICBjaGVja0FyZyhwYWdlLCAncGFnZScsICdudW1iZXInLCBmYWxzZSk7XG4gICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVUkx9LyR7dGhpcy5iYXNlfS8ke3RhYmxlfWA7XG4gICAgICBjb25zdCBvcHRzOiBTZWxlY3RPcHRpb25zID0gb3B0aW9ucyA/IHsgLi4ub3B0aW9ucyB9IDoge307XG4gICAgICBPYmplY3Qua2V5cyhvcHRzKS5mb3JFYWNoKChvcHRpb24pID0+IHtcbiAgICAgICAgaWYgKCF2YWxpZE9wdGlvbnMuaW5jbHVkZXMob3B0aW9uKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBvcHRpb246ICR7b3B0aW9ufWApO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxldCBvZmZzZXQ6IHN0cmluZyB8IHVuZGVmaW5lZCA9ICcnO1xuICAgICAgbGV0IGRhdGE6IEFpcnRhYmxlUmVjb3JkW10gPSBbXTtcbiAgICAgIGlmIChwYWdlKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZTsgaSsrKSB7XG4gICAgICAgICAgaWYgKG9mZnNldCkge1xuICAgICAgICAgICAgb3B0cy5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dXJsfT8ke2J1aWxkT3B0cyhvcHRzKX1gLCB7XG4gICAgICAgICAgICAgIGhlYWRlcnM6IHsgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgYm9keTogQWlydGFibGVSZWNvcmRSZXNwb25zZSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgICAgICBpZiAoY2hlY2tFcnJvcihyZXMuc3RhdHVzKSkge1xuICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyAhPT0gNDI5KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKEpTT04uc3RyaW5naWZ5KGJvZHkpKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICh0aGlzLnJldHJ5T25SYXRlTGltaXQpIHtcbiAgICAgICAgICAgICAgICBpZiAoaSArIDEgPT09IHBhZ2UpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCByYXRlTGltaXRIYW5kbGVyKFxuICAgICAgICAgICAgICAgICAgICBgJHt1cmx9PyR7YnVpbGRPcHRzKG9wdHMpfWAsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmV0cnlUaW1lb3V0LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1heFJldHJ5LFxuICAgICAgICAgICAgICAgICAgICAncmVjb3JkcycsXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGkgKyAxID09PSBwYWdlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBib2R5LnJlY29yZHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvZmZzZXQgPSBib2R5Lm9mZnNldDtcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IGRvbmUgPSBmYWxzZTtcbiAgICAgICAgd2hpbGUgKCFkb25lKSB7XG4gICAgICAgICAgaWYgKG9mZnNldCkge1xuICAgICAgICAgICAgb3B0cy5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dXJsfT8ke2J1aWxkT3B0cyhvcHRzKX1gLCB7XG4gICAgICAgICAgICAgIGhlYWRlcnM6IHsgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgYm9keTogQWlydGFibGVSZWNvcmRSZXNwb25zZSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgICAgICBpZiAoY2hlY2tFcnJvcihyZXMuc3RhdHVzKSkge1xuICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyAhPT0gNDI5KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKEpTT04uc3RyaW5naWZ5KGJvZHkpKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICh0aGlzLnJldHJ5T25SYXRlTGltaXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgcmF0ZUxpbWl0SGFuZGxlcihcbiAgICAgICAgICAgICAgICAgIGAke3VybH0/JHtidWlsZE9wdHMob3B0cyl9YCxcbiAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCB9LFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHRoaXMucmV0cnlUaW1lb3V0LFxuICAgICAgICAgICAgICAgICAgdGhpcy5tYXhSZXRyeSxcbiAgICAgICAgICAgICAgICAgICdyZWNvcmRzJyxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhID0gZGF0YS5jb25jYXQoYm9keS5yZWNvcmRzKTtcbiAgICAgICAgICAgIG9mZnNldCA9IGJvZHkub2Zmc2V0O1xuICAgICAgICAgICAgaWYgKCFib2R5Lm9mZnNldCkge1xuICAgICAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEZpbmRzIGEgcmVjb3JkIG9uIHRoZSBzcGVjaWZpZWQgdGFibGUuXG4gICAqIEBwYXJhbSB0YWJsZSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSBpZCBBaXJ0YWJsZSByZWNvcmQgSURcbiAgICogQHJldHVybnNcbiAgICogQGFzeW5jXG4gICAqL1xuICBmaW5kID0gYXN5bmMgKHRhYmxlOiBzdHJpbmcsIGlkOiBzdHJpbmcpOiBQcm9taXNlPEFpcnRhYmxlUmVjb3JkPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrQXJnKHRhYmxlLCAndGFibGUnLCAnc3RyaW5nJyk7XG4gICAgICBjaGVja0FyZyhpZCwgJ2lkJywgJ3N0cmluZycpO1xuICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVVJMfS8ke3RoaXMuYmFzZX0vJHt0YWJsZX0vJHtpZH1gO1xuICAgICAgY29uc3QgcmVzOiBSZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICBoZWFkZXJzOiB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gIH0sXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGRhdGE6IEFpcnRhYmxlUmVjb3JkID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgIGlmIChjaGVja0Vycm9yKHJlcy5zdGF0dXMpKSB7XG4gICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSA0MjkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmV0cnlPblJhdGVMaW1pdCkge1xuICAgICAgICAgIHJldHVybiBhd2FpdCByYXRlTGltaXRIYW5kbGVyKFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBoZWFkZXJzOiB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhpcy5yZXRyeVRpbWVvdXQsXG4gICAgICAgICAgICB0aGlzLm1heFJldHJ5LFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IHJlY29yZCBvbiB0aGUgc3BlY2lmaWVkIHRhYmxlLlxuICAgKiBAcGFyYW0gdGFibGUgLSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSByZWNvcmQgLSBSZWNvcmQgb2JqZWN0LCB1c2VkIHRvIHN0cnVjdHVyZSBkYXRhIGZvciBpbnNlcnRcbiAgICogQHBhcmFtIHR5cGVjYXN0IC0gVXNlZCBmb3IgYWxsb3dpbmcgdGhlIGFiaWxpdHkgdG8gYWRkIG5ldyBzZWxlY3Rpb25zIGZvciBTZWxlY3QgYW5kIE11bHRpc2VsZWN0IGZpZWxkcy5cbiAgICogQHJldHVybnNcbiAgICogQGFzeW5jXG4gICAqL1xuICBjcmVhdGVSZWNvcmQgPSBhc3luYyAoXG4gICAgdGFibGU6IHN0cmluZyxcbiAgICByZWNvcmQ6IEZpZWxkcyxcbiAgICB0eXBlY2FzdD86IFR5cGVjYXN0LFxuICApOiBQcm9taXNlPEFpcnRhYmxlUmVjb3JkPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrQXJnKHRhYmxlLCAndGFibGUnLCAnc3RyaW5nJyk7XG4gICAgICBjaGVja0FyZyhyZWNvcmQsICdyZWNvcmQnLCAnb2JqZWN0Jyk7XG4gICAgICBjaGVja0FyZyh0eXBlY2FzdCwgJ3R5cGVjYXN0JywgJ2Jvb2xlYW4nLCBmYWxzZSk7XG4gICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVUkx9LyR7dGhpcy5iYXNlfS8ke3RhYmxlfWA7XG4gICAgICBjb25zdCBib2R5OiBxdWVyeUJvZHkgPSB7IGZpZWxkczogcmVjb3JkIH07XG4gICAgICBpZiAodHlwZWNhc3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBib2R5LnR5cGVjYXN0ID0gdHlwZWNhc3Q7XG4gICAgICB9XG4gICAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGRhdGE6IEFpcnRhYmxlUmVjb3JkID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgIGlmIChjaGVja0Vycm9yKHJlcy5zdGF0dXMpKSB7XG4gICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSA0MjkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmV0cnlPblJhdGVMaW1pdCkge1xuICAgICAgICAgIHJldHVybiBhd2FpdCByYXRlTGltaXRIYW5kbGVyKFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXMucmV0cnlUaW1lb3V0LFxuICAgICAgICAgICAgdGhpcy5tYXhSZXRyeSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnIpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogVXBkYXRlcyBhIHJlY29yZCBvbiB0aGUgc3BlY2lmaWVkIHRhYmxlLlxuICAgKiBAcGFyYW0gdGFibGUgLSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSByZWNvcmQgLSBSZWNvcmQgb2JqZWN0LCB1c2VkIHRvIHVwZGF0ZSBkYXRhIHdpdGhpbiBhIHNwZWNpZmljIHJlY29yZFxuICAgKiBAcGFyYW0gb3B0cyAtIEFuIG9iamVjdCB3aXRoIG9wdGlvbnMgZm9yIHlvdXIgdXBkYXRlIHN0YXRlbWVudFxuICAgKiBAcmV0dXJuc1xuICAgKiBAYXN5bmNcbiAgICovXG4gIHVwZGF0ZVJlY29yZCA9IGFzeW5jIChcbiAgICB0YWJsZTogc3RyaW5nLFxuICAgIHJlY29yZDogQWlydGFibGVVcGRhdGVSZWNvcmQsXG4gICAgb3B0cz86IHVwZGF0ZU9wdHMsXG4gICk6IFByb21pc2U8QWlydGFibGVSZWNvcmQ+ID0+IHtcbiAgICB0cnkge1xuICAgICAgY2hlY2tBcmcodGFibGUsICd0YWJsZScsICdzdHJpbmcnKTtcbiAgICAgIGNoZWNrQXJnKHJlY29yZCwgJ3JlY29yZCcsICdvYmplY3QnKTtcbiAgICAgIGlmIChvcHRzKSB7XG4gICAgICAgIGNoZWNrQXJnKG9wdHMuZGVzdHJ1Y3RpdmUsICdvcHRzLmRlc2N0cnVjdGl2ZScsICdib29sZWFuJyk7XG4gICAgICAgIGNoZWNrQXJnKG9wdHMudHlwZWNhc3QsICdvcHRzLnR5cGVjYXN0JywgJ2Jvb2xlYW4nLCBmYWxzZSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVUkx9LyR7dGhpcy5iYXNlfS8ke3RhYmxlfS8ke3JlY29yZC5pZH1gO1xuICAgICAgY29uc3QgYm9keTogcXVlcnlCb2R5ID0geyBmaWVsZHM6IHJlY29yZC5maWVsZHMgfTtcbiAgICAgIGlmIChvcHRzPy50eXBlY2FzdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGJvZHkudHlwZWNhc3QgPSBvcHRzPy50eXBlY2FzdDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlczogUmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgbWV0aG9kOiBvcHRzPy5kZXN0cnVjdGl2ZSA/ICdwdXQnIDogJ3BhdGNoJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBjb25zdCBkYXRhOiBBaXJ0YWJsZVJlY29yZCA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICBpZiAoY2hlY2tFcnJvcihyZXMuc3RhdHVzKSkge1xuICAgICAgICBpZiAocmVzLnN0YXR1cyAhPT0gNDI5KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnJldHJ5T25SYXRlTGltaXQpIHtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgcmF0ZUxpbWl0SGFuZGxlcihcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbWV0aG9kOiBvcHRzPy5kZXN0cnVjdGl2ZSA/ICdwdXQnIDogJ3BhdGNoJyxcbiAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXMucmV0cnlUaW1lb3V0LFxuICAgICAgICAgICAgdGhpcy5tYXhSZXRyeSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnIpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogRGVsZXRlcyBhIHJlY29yZCBmcm9tIHRoZSBzcGVjaWZpZWQgdGFibGUuXG4gICAqIEBwYXJhbSB0YWJsZSAtIFRhYmxlIG5hbWVcbiAgICogQHBhcmFtIGlkIC0gQWlydGFibGUgcmVjb3JkIElEXG4gICAqIEByZXR1cm5zXG4gICAqIEBhc3luY1xuICAgKi9cbiAgZGVsZXRlUmVjb3JkID0gYXN5bmMgKHRhYmxlOiBzdHJpbmcsIGlkOiBzdHJpbmcpOiBQcm9taXNlPERlbGV0ZVJlc3BvbnNlPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrQXJnKHRhYmxlLCAndGFibGUnLCAnc3RyaW5nJyk7XG4gICAgICBjaGVja0FyZyhpZCwgJ2lkJywgJ3N0cmluZycpO1xuICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVVJMfS8ke3RoaXMuYmFzZX0vJHt0YWJsZX0vJHtpZH1gO1xuICAgICAgY29uc3QgcmVzOiBSZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICBtZXRob2Q6ICdkZWxldGUnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGRhdGE6IERlbGV0ZVJlc3BvbnNlID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgIGlmIChjaGVja0Vycm9yKHJlcy5zdGF0dXMpKSB7XG4gICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSA0MjkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmV0cnlPblJhdGVMaW1pdCkge1xuICAgICAgICAgIHJldHVybiBhd2FpdCByYXRlTGltaXRIYW5kbGVyKFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdkZWxldGUnLFxuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhpcy5yZXRyeVRpbWVvdXQsXG4gICAgICAgICAgICB0aGlzLm1heFJldHJ5LFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIG11bHRpcGxlIG5ldyByZWNvcmRzIG9uIHRoZSBzcGVjaWZpZWQgdGFibGUuXG4gICAqIEBwYXJhbSB0YWJsZSAtIFRhYmxlIG5hbWVcbiAgICogQHBhcmFtIHJlY29yZHMgLSBBbiBhcnJheSBvZiBSZWNvcmQgb2JqZWN0c1xuICAgKiBAcGFyYW0gdHlwZWNhc3QgLSBVc2VkIGZvciBhbGxvd2luZyB0aGUgYWJpbGl0eSB0byBhZGQgbmV3IHNlbGVjdGlvbnMgZm9yIFNlbGVjdCBhbmQgTXVsdGlzZWxlY3QgZmllbGRzLlxuICAgKiBAcmV0dXJuc1xuICAgKiBAYXN5bmNcbiAgICovXG4gIGJ1bGtDcmVhdGUgPSBhc3luYyAoXG4gICAgdGFibGU6IHN0cmluZyxcbiAgICByZWNvcmRzOiBGaWVsZHNbXSxcbiAgICB0eXBlY2FzdD86IFR5cGVjYXN0LFxuICApOiBQcm9taXNlPEFpcnRhYmxlUmVjb3JkW10+ID0+IHtcbiAgICB0cnkge1xuICAgICAgY2hlY2tBcmcodGFibGUsICd0YWJsZScsICdzdHJpbmcnKTtcbiAgICAgIGNoZWNrQXJnKHJlY29yZHMsICdyZWNvcmRzJywgJ2FycmF5Jyk7XG4gICAgICBjaGVja0FyZyh0eXBlY2FzdCwgJ3R5cGVjYXN0JywgJ2Jvb2xlYW4nLCBmYWxzZSk7XG4gICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVUkx9LyR7dGhpcy5iYXNlfS8ke3RhYmxlfWA7XG4gICAgICBjb25zdCBib2R5OiBidWxrUXVlcnlCb2R5ID0ge1xuICAgICAgICByZWNvcmRzOiByZWNvcmRzLm1hcCgocmVjb3JkKSA9PiAoe1xuICAgICAgICAgIGZpZWxkczogcmVjb3JkLFxuICAgICAgICB9KSksXG4gICAgICB9O1xuICAgICAgaWYgKHR5cGVjYXN0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgYm9keS50eXBlY2FzdCA9IHR5cGVjYXN0O1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzOiBSZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBjb25zdCBkYXRhOiBBaXJ0YWJsZVJlY29yZFJlc3BvbnNlID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgIGlmIChjaGVja0Vycm9yKHJlcy5zdGF0dXMpKSB7XG4gICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSA0MjkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmV0cnlPblJhdGVMaW1pdCkge1xuICAgICAgICAgIHJldHVybiBhd2FpdCByYXRlTGltaXRIYW5kbGVyKFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXMucmV0cnlUaW1lb3V0LFxuICAgICAgICAgICAgdGhpcy5tYXhSZXRyeSxcbiAgICAgICAgICAgICdyZWNvcmRzJyxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YS5yZWNvcmRzO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIG11bHRpcGxlIHJlY29yZHMgb24gdGhlIHNwZWNpZmllZCB0YWJsZVxuICAgKiBAcGFyYW0gdGFibGUgLSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSByZWNvcmRzIC0gQW4gYXJyYXkgb2YgUmVjb3JkIG9iamVjdHNcbiAgICogQHBhcmFtIG9wdHMgLSBBbiBvYmplY3Qgd2l0aCBvcHRpb25zIGZvciB5b3VyIHVwZGF0ZSBzdGF0ZW1lbnRcbiAgICogQHJldHVybnNcbiAgICogQGFzeW5jXG4gICAqL1xuICBidWxrVXBkYXRlID0gYXN5bmMgKFxuICAgIHRhYmxlOiBzdHJpbmcsXG4gICAgcmVjb3JkczogQWlydGFibGVVcGRhdGVSZWNvcmRbXSxcbiAgICBvcHRzPzogdXBkYXRlT3B0cyxcbiAgKTogUHJvbWlzZTxBaXJ0YWJsZVJlY29yZFtdPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrQXJnKHRhYmxlLCAndGFibGUnLCAnc3RyaW5nJyk7XG4gICAgICBjaGVja0FyZyhyZWNvcmRzLCAncmVjb3JkcycsICdhcnJheScpO1xuICAgICAgaWYgKG9wdHMpIHtcbiAgICAgICAgY2hlY2tBcmcob3B0cy5kZXN0cnVjdGl2ZSwgJ29wdHMuZGVzY3RydWN0aXZlJywgJ2Jvb2xlYW4nLCBmYWxzZSk7XG4gICAgICAgIGNoZWNrQXJnKG9wdHMudHlwZWNhc3QsICdvcHRzLnR5cGVjYXN0JywgJ2Jvb2xlYW4nLCBmYWxzZSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVUkx9LyR7dGhpcy5iYXNlfS8ke3RhYmxlfWA7XG4gICAgICBjb25zdCBib2R5OiBidWxrUXVlcnlCb2R5ID0geyByZWNvcmRzIH07XG4gICAgICBpZiAob3B0cz8udHlwZWNhc3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBib2R5LnR5cGVjYXN0ID0gb3B0cz8udHlwZWNhc3Q7XG4gICAgICB9XG4gICAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogb3B0cz8uZGVzdHJ1Y3RpdmUgPyAncHV0JyA6ICdwYXRjaCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgZGF0YTogQWlydGFibGVSZWNvcmRSZXNwb25zZSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICBpZiAoY2hlY2tFcnJvcihyZXMuc3RhdHVzKSkge1xuICAgICAgICBpZiAocmVzLnN0YXR1cyAhPT0gNDI5KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnJldHJ5T25SYXRlTGltaXQpIHtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgcmF0ZUxpbWl0SGFuZGxlcihcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbWV0aG9kOiBvcHRzPy5kZXN0cnVjdGl2ZSA/ICdwdXQnIDogJ3BhdGNoJyxcbiAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXMucmV0cnlUaW1lb3V0LFxuICAgICAgICAgICAgdGhpcy5tYXhSZXRyeSxcbiAgICAgICAgICAgICdyZWNvcmRzJyxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YS5yZWNvcmRzO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBEZWxldGVzIG11bHRpcGxlIHJlY29yZHMgZnJvbSB0aGUgc3BlY2lmaWVkIHRhYmxlXG4gICAqIEBwYXJhbSB0YWJsZSAtIFRhYmxlIG5hbWVcbiAgICogQHBhcmFtIGlkcyAtIEFycmF5IG9mIEFpcnRhYmxlIHJlY29yZCBJRHNcbiAgICogQHJldHVybnNcbiAgICogQGFzeW5jXG4gICAqL1xuICBidWxrRGVsZXRlID0gYXN5bmMgKFxuICAgIHRhYmxlOiBzdHJpbmcsXG4gICAgaWRzOiBzdHJpbmdbXSxcbiAgKTogUHJvbWlzZTxEZWxldGVSZXNwb25zZVtdPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrQXJnKHRhYmxlLCAndGFibGUnLCAnc3RyaW5nJyk7XG4gICAgICBjaGVja0FyZyhpZHMsICdpZHMnLCAnYXJyYXknKTtcbiAgICAgIGxldCBxdWVyeSA9ICcnO1xuICAgICAgaWRzLmZvckVhY2goKGlkLCBpKSA9PiB7XG4gICAgICAgIGlmIChpICE9PSAwKSB7XG4gICAgICAgICAgcXVlcnkgPSBgJHtxdWVyeX0mcmVjb3Jkc1tdPSR7aWR9YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBxdWVyeSA9IGByZWNvcmRzW109JHtpZH1gO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYmFzZVVSTH0vJHt0aGlzLmJhc2V9LyR7dGFibGV9PyR7ZW5jb2RlVVJJKHF1ZXJ5KX1gO1xuICAgICAgY29uc3QgcmVzOiBSZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICBtZXRob2Q6ICdkZWxldGUnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGRhdGE6IEFpcnRhYmxlRGVsZXRlZFJlc3BvbnNlID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgIGlmIChjaGVja0Vycm9yKHJlcy5zdGF0dXMpKSB7XG4gICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSA0MjkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmV0cnlPblJhdGVMaW1pdCkge1xuICAgICAgICAgIHJldHVybiBhd2FpdCByYXRlTGltaXRIYW5kbGVyKFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdkZWxldGUnLFxuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhpcy5yZXRyeVRpbWVvdXQsXG4gICAgICAgICAgICB0aGlzLm1heFJldHJ5LFxuICAgICAgICAgICAgJ3JlY29yZHMnLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBkYXRhLnJlY29yZHM7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBhIHJlY29yZCBleGlzdHMsIGFuZCBpZiBpdCBkb2VzIHVwZGF0ZXMgaXQsIGlmIG5vdCBjcmVhdGVzIGEgbmV3IHJlY29yZC5cbiAgICogQHBhcmFtIHRhYmxlIC0gVGFibGUgbmFtZVxuICAgKiBAcGFyYW0gZmlsdGVyU3RyaW5nIC0gVGhlIGZpbHRlciBmb3JtdWxhIHN0cmluZyB1c2VkIHRvIGNoZWNrIGZvciBhIHJlY29yZFxuICAgKiBAcGFyYW0gcmVjb3JkIC0gUmVjb3JkIG9iamVjdCB1c2VkIHRvIGVpdGhlciB1cGRhdGUgb3IgY3JlYXRlIGEgcmVjb3JkXG4gICAqIEBwYXJhbSBvcHRzIC0gQW4gb2JqZWN0IHdpdGggb3B0aW9ucyBmb3IgeW91ciB1cGRhdGUgc3RhdGVtZW50XG4gICAqIEByZXR1cm5zXG4gICAqIEBhc3luY1xuICAgKi9cbiAgdXBzZXJ0UmVjb3JkID0gYXN5bmMgKFxuICAgIHRhYmxlOiBzdHJpbmcsXG4gICAgZmlsdGVyU3RyaW5nOiBzdHJpbmcsXG4gICAgcmVjb3JkOiBGaWVsZHMsXG4gICAgb3B0cz86IHVwZGF0ZU9wdHMsXG4gICk6IFByb21pc2U8QWlydGFibGVSZWNvcmQ+ID0+IHtcbiAgICBjaGVja0FyZyh0YWJsZSwgJ3RhYmxlJywgJ3N0cmluZycpO1xuICAgIGNoZWNrQXJnKGZpbHRlclN0cmluZywgJ2ZpbHRlclN0cmluZycsICdzdHJpbmcnKTtcbiAgICBjaGVja0FyZyhyZWNvcmQsICdyZWNvcmQnLCAnb2JqZWN0Jyk7XG4gICAgaWYgKG9wdHMpIHtcbiAgICAgIGNoZWNrQXJnKG9wdHMuZGVzdHJ1Y3RpdmUsICdvcHRzLmRlc2N0cnVjdGl2ZScsICdib29sZWFuJywgZmFsc2UpO1xuICAgICAgY2hlY2tBcmcob3B0cy50eXBlY2FzdCwgJ29wdHMudHlwZWNhc3QnLCAnYm9vbGVhbicsIGZhbHNlKTtcbiAgICB9XG4gICAgY29uc3QgZXhpc3RzID0gYXdhaXQgdGhpcy5zZWxlY3QodGFibGUsIHsgZmlsdGVyQnlGb3JtdWxhOiBmaWx0ZXJTdHJpbmcgfSk7XG4gICAgaWYgKCFleGlzdHNbMF0pIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmNyZWF0ZVJlY29yZCh0YWJsZSwgcmVjb3JkLCBvcHRzPy50eXBlY2FzdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnVwZGF0ZVJlY29yZChcbiAgICAgICAgdGFibGUsXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogZXhpc3RzWzBdLmlkLFxuICAgICAgICAgIGZpZWxkczogcmVjb3JkLFxuICAgICAgICB9LFxuICAgICAgICBvcHRzLFxuICAgICAgKTtcbiAgICB9XG4gIH07XG59XG5cbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICB3aW5kb3cuQXN5bmNBaXJ0YWJsZSA9IEFzeW5jQWlydGFibGU7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9
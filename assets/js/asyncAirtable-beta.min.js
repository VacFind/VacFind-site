(()=>{"use strict";var t={300:(t,e)=>{var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r)return r;throw new Error("unable to locate global object")}();t.exports=e=r.fetch,r.fetch&&(e.default=r.fetch.bind(r)),e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response}},e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={exports:{}};return t[i](o,o.exports,r),o.exports}(()=>{var t=r(300);const e="undefined"!=typeof window?window.fetch.bind(window):t,i={$arrayCompact:t=>`ARRAYCOMPACT({${t}})`,$arrayFlatten:t=>`ARRAYFLATTEN({${t}})`,$arrayUnique:t=>`ARRAYUNIQUE({${t}})`,$arrayJoin:(t,e=",")=>`ARRAYJOIN({${t}}, '${e}')`},o=t=>{if(null===t)return"BLANK()";switch(typeof t){case"number":return`${t}`;case"string":return`'${t}'`;case"boolean":return(t=>{if("boolean"!=typeof t)throw new Error("Invalid type");return t?"TRUE()":"FALSE()"})(t);default:throw new Error("Wrong Type")}},n={$not:t=>`NOT(${$(t)})`,$and:t=>`AND(${$(t)})`,$or:t=>`OR(${$(t)})`},s=["=","!=",">",">=","<","<="],a=(t,e)=>{if("object"!=typeof t||Array.isArray(t))throw new Error("Missing or Invalid Comparison Object");if("string"!=typeof e&&!s.includes(e))throw new Error("Missing or Invalid Comparison Operator");const r=Object.keys(t),i=`${r.map(((i,o)=>{const n=$(t[i]);return`{${i}} ${e} ${n}${o<r.length-1?", ":""}`})).join("")}`;return r.length>1?`AND(${i})`:i},c={$gt:t=>a(t,">"),$lt:t=>a(t,"<"),$gte:t=>a(t,">="),$lte:t=>a(t,"<="),$eq:t=>a(t,"="),$neq:t=>a(t,"!=")},d={$textFind:(t,e,r=0)=>`FIND(${"string"==typeof t?o(t):$(t)}, ${"string"==typeof e?o(e):$(e)}, ${r})`,$textSearch:(t,e,r=0)=>`SEARCH(${"string"==typeof t?o(t):$(t)}, ${"string"==typeof e?o(e):$(e)}, ${r})`},y=t=>{if(void 0===t)throw new Error("Missing Query Object");return null!==t&&t instanceof Object&&!Array.isArray(t)},h=t=>t instanceof Array&&t.every((t=>y(t))),u=t=>t instanceof Array&&t.every((t=>"string"==typeof t)),f=t=>"string"==typeof t||t instanceof Object&&!Array.isArray(t)&&"string"==typeof(null==t?void 0:t.$fieldName),l=t=>t.every((t=>null!=t)),p=t=>"object"!=typeof t||null===t,$=t=>{var e,r;if(void 0!==t&&!(t instanceof Function)){if(p(t))return o(t);if(t instanceof Array)return t.map((t=>$(t))).join(", ").trim();const s=Object.keys(t),a=Object.values(t);if(s.length>1&&l(a)&&h(s.map(((t,e)=>({[t]:a[e]})))))return n.$and(s.map(((t,e)=>({[t]:a[e]}))));const w=s[0];if(void 0===t[w])throw new Error("Invalid query");if("$fieldName"===w)return`{${t.$fieldName}}`;const v=t[w];if(void 0!==v){if(w in n&&(y(v)||h(v)))return n[w](v);if(w in i){if(u(v)&&u(r=v)&&2===r.length)return i[w](...v);if("string"==typeof v)return i[w](v)}else{if(w in d&&Array.isArray(v)&&(t=>t instanceof Array&&(3===t.length&&"number"==typeof t[2]||2===t.length&&(f(t[0])||y(t[0]))&&(f(t[1])||y(t[1]))))(v))return d[w](v[0],v[1],null!==(e=v[2])&&void 0!==e?e:0);if(y(v)){const t=Object.keys(v),e=Object.values(v);if(t.length>1&&l(e)&&h(t.map(((t,r)=>({[t]:e[r]}))))&&t.every((t=>t in c))&&e.every((t=>y(t)||p(t))))return n.$and(t.map(((t,r)=>({[w]:{[t]:e[r]}}))));const r=t[0],i=e[0];if(r in c&&(y(i)||p(i)))return c[r]({[w]:i})}else if(y(v)||p(v))return c.$eq({[w]:v})}}}throw new Error("Invalid Query Object")},w=t=>{if(Object.prototype.hasOwnProperty.call(t,"filterByFormula")&&Object.prototype.hasOwnProperty.call(t,"where"))throw new Error("Cannot use both where and filterByFormula as they accomplish the same thing");const e=Object.keys(t).map(((e,r)=>{const i=t[e];let o;return o=Array.isArray(i)?i.map(((t,r)=>{switch(typeof t){case"object":return Object.keys(t).map((i=>`${e}[${r}][${i}]=${t[i]}`)).join("&");case"string":return`${e}[]=${t}`}})).join("&"):"where"===e?`filterByFormula=${$(i)}`:`${e}=${i}`,0!==r?`&${o}`:o})).join("");return encodeURI(e)},v=t=>t>=300,m=(t,e,r,i=!0)=>{if(void 0===t&&i)throw new Error(`Argument "${e}" is required.`);if((void 0!==t||i)&&typeof t!==r){if("array"===r&&Array.isArray(t))return;throw new Error(`Incorrect data type on argument "${e}". Received "${typeof t}": expected "${r}"`)}};var b=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function s(t){try{c(i.next(t))}catch(t){n(t)}}function a(t){try{c(i.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};const g=(t,r,i,o,n)=>b(void 0,void 0,void 0,(function*(){return new Promise(((s,a)=>{const c=(t,r,i,o,n)=>{o&&o<1&&a("Max timeout exceeded"),setTimeout((()=>b(void 0,void 0,void 0,(function*(){try{const a=yield e(t,r),d=yield a.json();if(429===a.status)return c(t,r,1.5*i,o-i,n);s(n?d[n]:d)}catch(t){a(t)}}))),i)};c(t,r,i,o,n)}))}));var A=function(t,e,r,i){return new(r||(r=Promise))((function(o,n){function s(t){try{c(i.next(t))}catch(t){n(t)}}function a(t){try{c(i.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};const O="https://api.airtable.com/v0",j=["fields","filterByFormula","maxRecords","pageSize","sort","view","where"];"undefined"!=typeof window&&(window.AsyncAirtable=class{constructor(t,r,i){if(this.select=(t,r,i)=>A(this,void 0,void 0,(function*(){try{m(t,"table","string"),m(r,"options","object",!1),m(i,"page","number",!1);const o=`${O}/${this.base}/${t}`,n=r?Object.assign({},r):{};Object.keys(n).forEach((t=>{if(!j.includes(t))throw new Error(`Invalid option: ${t}`)}));let s="",a=[];if(i)for(let t=0;t<i;t++){s&&(n.offset=s);try{const r=yield e(`${o}?${w(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}}),a=yield r.json();if(v(r.status)){if(429!==r.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit&&t+1===i)return yield g(`${o}?${w(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry,"records")}if(t+1===i)return a.records;s=a.offset}catch(t){throw new Error(t)}}else{let t=!1;for(;!t;){s&&(n.offset=s);try{const r=yield e(`${o}?${w(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}}),i=yield r.json();if(v(r.status)){if(429!==r.status)throw new Error(JSON.stringify(i));if(this.retryOnRateLimit)return yield g(`${o}?${w(n)}`,{headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry,"records")}a=a.concat(i.records),s=i.offset,i.offset||(t=!0)}catch(t){throw new Error(t)}}}return a}catch(t){throw new Error(t)}})),this.find=(t,r)=>A(this,void 0,void 0,(function*(){try{m(t,"table","string"),m(r,"id","string");const i=`${O}/${this.base}/${t}/${r}`,o=yield e(i,{headers:{Authorization:`Bearer ${this.apiKey}`}}),n=yield o.json();if(v(o.status)){if(429!==o.status)throw new Error(JSON.stringify(n));if(this.retryOnRateLimit)return yield g(i,{headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry)}return n}catch(t){throw new Error(t)}})),this.createRecord=(t,r,i)=>A(this,void 0,void 0,(function*(){try{m(t,"table","string"),m(r,"record","object"),m(i,"typecast","boolean",!1);const o=`${O}/${this.base}/${t}`,n={fields:r};void 0!==i&&(n.typecast=i);const s=yield e(o,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(v(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield g(o,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry)}return a}catch(t){throw new Error(t)}})),this.updateRecord=(t,r,i)=>A(this,void 0,void 0,(function*(){try{m(t,"table","string"),m(r,"record","object"),i&&(m(i.destructive,"opts.desctructive","boolean"),m(i.typecast,"opts.typecast","boolean",!1));const o=`${O}/${this.base}/${t}/${r.id}`,n={fields:r.fields};void 0!==(null==i?void 0:i.typecast)&&(n.typecast=null==i?void 0:i.typecast);const s=yield e(o,{method:(null==i?void 0:i.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(v(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield g(o,{method:(null==i?void 0:i.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry)}return a}catch(t){throw new Error(t)}})),this.deleteRecord=(t,r)=>A(this,void 0,void 0,(function*(){try{m(t,"table","string"),m(r,"id","string");const i=`${O}/${this.base}/${t}/${r}`,o=yield e(i,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}}),n=yield o.json();if(v(o.status)){if(429!==o.status)throw new Error(JSON.stringify(n));if(this.retryOnRateLimit)return yield g(i,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry)}return n}catch(t){throw new Error(t)}})),this.bulkCreate=(t,r,i)=>A(this,void 0,void 0,(function*(){try{m(t,"table","string"),m(r,"records","array"),m(i,"typecast","boolean",!1);const o=`${O}/${this.base}/${t}`,n={records:r.map((t=>({fields:t})))};void 0!==i&&(n.typecast=i);const s=yield e(o,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(v(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield g(o,{method:"post",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry,"records")}return a.records}catch(t){throw new Error(t)}})),this.bulkUpdate=(t,r,i)=>A(this,void 0,void 0,(function*(){try{m(t,"table","string"),m(r,"records","array"),i&&(m(i.destructive,"opts.desctructive","boolean",!1),m(i.typecast,"opts.typecast","boolean",!1));const o=`${O}/${this.base}/${t}`,n={records:r};void 0!==(null==i?void 0:i.typecast)&&(n.typecast=null==i?void 0:i.typecast);const s=yield e(o,{method:(null==i?void 0:i.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}),a=yield s.json();if(v(s.status)){if(429!==s.status)throw new Error(JSON.stringify(a));if(this.retryOnRateLimit)return yield g(o,{method:(null==i?void 0:i.destructive)?"put":"patch",body:JSON.stringify(n),headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}},this.retryTimeout,this.maxRetry,"records")}return a.records}catch(t){throw new Error(t)}})),this.bulkDelete=(t,r)=>A(this,void 0,void 0,(function*(){try{m(t,"table","string"),m(r,"ids","array");let i="";r.forEach(((t,e)=>{i=0!==e?`${i}&records[]=${t}`:`records[]=${t}`}));const o=`${O}/${this.base}/${t}?${encodeURI(i)}`,n=yield e(o,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}}),s=yield n.json();if(v(n.status)){if(429!==n.status)throw new Error(JSON.stringify(s));if(this.retryOnRateLimit)return yield g(o,{method:"delete",headers:{Authorization:`Bearer ${this.apiKey}`}},this.retryTimeout,this.maxRetry,"records")}return s.records}catch(t){throw new Error(t)}})),this.upsertRecord=(t,e,r,i)=>A(this,void 0,void 0,(function*(){m(t,"table","string"),m(e,"filterString","string"),m(r,"record","object"),i&&(m(i.destructive,"opts.desctructive","boolean",!1),m(i.typecast,"opts.typecast","boolean",!1));const o=yield this.select(t,{filterByFormula:e});return o[0]?yield this.updateRecord(t,{id:o[0].id,fields:r},i):yield this.createRecord(t,r,null==i?void 0:i.typecast)})),!t)throw new Error("API Key is required.");if(!r)throw new Error("Base ID is required.");this.apiKey=t,this.base=r,this.retryOnRateLimit=(null==i?void 0:i.retryOnRateLimit)||!0,this.retryTimeout=(null==i?void 0:i.retryTimeout)||5e3,this.maxRetry=(null==i?void 0:i.maxRetry)||6e4}})})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vbm9kZV9tb2R1bGVzL25vZGUtZmV0Y2gvYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2FzeW5jYWlydGFibGUvLi9zcmMvZmV0Y2gudHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9hcnJheUZ1bmN0aW9ucy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL2Jhc2VIYW5kbGVycy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL2xvZ2ljYWxGdW5jdGlvbnMudHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9idWlsZEV4cHJlc3Npb24udHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9sb2dpY2FsT3BlcmF0b3JzLnRzIiwid2VicGFjazovL2FzeW5jYWlydGFibGUvLi9zcmMvdGV4dEZ1bmN0aW9ucy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL3R5cGVDaGVja2Vycy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL3F1ZXJ5QnVpbGRlci50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL2J1aWxkT3B0cy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL2NoZWNrRXJyb3IudHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9jaGVja0FyZy50cyIsIndlYnBhY2s6Ly9hc3luY2FpcnRhYmxlLy4vc3JjL3JhdGVMaW1pdEhhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vYXN5bmNhaXJ0YWJsZS8uL3NyYy9hc3luY0FpcnRhYmxlLnRzIl0sIm5hbWVzIjpbImdsb2JhbCIsInNlbGYiLCJ3aW5kb3ciLCJFcnJvciIsImdldEdsb2JhbCIsIm1vZHVsZSIsImV4cG9ydHMiLCJmZXRjaCIsImRlZmF1bHQiLCJiaW5kIiwiSGVhZGVycyIsIlJlcXVlc3QiLCJSZXNwb25zZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJhcnJheUZ1bmN0aW9ucyIsIiRhcnJheUNvbXBhY3QiLCJmaWVsZE5hbWUiLCIkYXJyYXlGbGF0dGVuIiwiJGFycmF5VW5pcXVlIiwiJGFycmF5Sm9pbiIsInNlcGVyYXRvciIsImJhc2VIYW5kbGVyIiwidmFsIiwiYm9vbCIsImJvb2xlYW5IYW5kbGVyIiwibG9naWNhbEZ1bmN0aW9ucyIsIiRub3QiLCJleHByZXNzaW9uIiwicXVlcnlCdWlsZGVyIiwiJGFuZCIsImFyZ3MiLCIkb3IiLCJvcGVyYXRvcnMiLCJidWlsZEV4cHJlc3Npb24iLCJvYmoiLCJvcCIsIkFycmF5IiwiaXNBcnJheSIsImluY2x1ZGVzIiwia2V5cyIsIk9iamVjdCIsImV4cCIsIm1hcCIsImsiLCJpIiwibGVuZ3RoIiwiam9pbiIsImxvZ2ljYWxPcGVyYXRvcnMiLCIkZ3QiLCIkbHQiLCIkZ3RlIiwiJGx0ZSIsIiRlcSIsIiRuZXEiLCJ0ZXh0RnVuY3Rpb25zIiwiJHRleHRGaW5kIiwic2VhcmNoIiwic2V0Iiwic3RhcnRJbmRleCIsIiR0ZXh0U2VhcmNoIiwiaXNRdWVyeU9iamVjdCIsIml0ZW0iLCJ1bmRlZmluZWQiLCJpc1F1ZXJ5T2JqZWN0QXJyYXkiLCJhcnIiLCJldmVyeSIsInYiLCJpc1N0cmluZ0FycmF5IiwiaXNTdHJpbmdPckZpZWxkTmFtZU9iamVjdCIsIiRmaWVsZE5hbWUiLCJhbGxJbmRleGVzVmFsaWQiLCJlIiwiaXNCYXNlRmllbGQiLCJhcmciLCJGdW5jdGlvbiIsImEiLCJ0cmltIiwidmFscyIsInZhbHVlcyIsImtleSIsImlzVGV4dEFyZ3MiLCJ2YWxLZXlzIiwic3ViVmFscyIsInZhbEtleSIsInN1YlZhbCIsIm9wdHMiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJwYXJhbXMiLCJvcHQiLCJmb3JtYXR0ZWQiLCJqIiwic3ViS2V5IiwiZW5jb2RlVVJJIiwic3RhdHVzIiwibmFtZSIsInR5cGUiLCJyZXF1aXJlZCIsInVybCIsInJldHJ5VGltZW91dCIsIm1heFJldHJ5IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZXRyeVJhdGVMaW1pdCIsInNldFRpbWVvdXQiLCJyZXMiLCJkYXRhIiwianNvbiIsImVyciIsImJhc2VVUkwiLCJ2YWxpZE9wdGlvbnMiLCJBc3luY0FpcnRhYmxlIiwiYXBpS2V5IiwiYmFzZSIsImNvbmZpZyIsInNlbGVjdCIsInRhYmxlIiwib3B0aW9ucyIsInBhZ2UiLCJjaGVja0FyZyIsInRoaXMiLCJmb3JFYWNoIiwib3B0aW9uIiwib2Zmc2V0IiwiYnVpbGRPcHRzIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJib2R5IiwiY2hlY2tFcnJvciIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZXRyeU9uUmF0ZUxpbWl0IiwicmF0ZUxpbWl0SGFuZGxlciIsInJlY29yZHMiLCJkb25lIiwiY29uY2F0IiwiZmluZCIsImlkIiwiY3JlYXRlUmVjb3JkIiwicmVjb3JkIiwidHlwZWNhc3QiLCJmaWVsZHMiLCJtZXRob2QiLCJ1cGRhdGVSZWNvcmQiLCJkZXN0cnVjdGl2ZSIsImRlbGV0ZVJlY29yZCIsImJ1bGtDcmVhdGUiLCJidWxrVXBkYXRlIiwiYnVsa0RlbGV0ZSIsImlkcyIsInF1ZXJ5IiwidXBzZXJ0UmVjb3JkIiwiZmlsdGVyU3RyaW5nIiwiZXhpc3RzIiwiZmlsdGVyQnlGb3JtdWxhIl0sIm1hcHBpbmdzIjoic0NBR0EsSUFVSUEsRUFWWSxXQUlmLEdBQW9CLG9CQUFUQyxLQUF3QixPQUFPQSxLQUMxQyxHQUFzQixvQkFBWEMsT0FBMEIsT0FBT0EsT0FDNUMsUUFBc0IsSUFBWEYsRUFBMEIsT0FBT0EsRUFDNUMsTUFBTSxJQUFJRyxNQUFNLGtDQUdKQyxHQUViQyxFQUFPQyxRQUFVQSxFQUFVTixFQUFPTyxNQUc5QlAsRUFBT08s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LEtBQUtQLEtBQU9BLEVBQ1pPLEtBQUtXLGtCQUFtQmpCLGFBQU0sRUFBTkEsRUFBUWlCLG9CQUFvQixFQUNwRFgsS0FBS3RCLGNBQWVnQixhQUFNLEVBQU5BLEVBQVFoQixlQUFnQixJQUM1Q3NCLEtBQUtyQixVQUFXZSxhQUFNLEVBQU5BLEVBQVFmLFdBQVksUSIsImZpbGUiOiJhc3luY0FpcnRhYmxlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vLyByZWY6IGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLWdsb2JhbFxudmFyIGdldEdsb2JhbCA9IGZ1bmN0aW9uICgpIHtcblx0Ly8gdGhlIG9ubHkgcmVsaWFibGUgbWVhbnMgdG8gZ2V0IHRoZSBnbG9iYWwgb2JqZWN0IGlzXG5cdC8vIGBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpYFxuXHQvLyBIb3dldmVyLCB0aGlzIGNhdXNlcyBDU1AgdmlvbGF0aW9ucyBpbiBDaHJvbWUgYXBwcy5cblx0aWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykgeyByZXR1cm4gc2VsZjsgfVxuXHRpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHsgcmV0dXJuIHdpbmRvdzsgfVxuXHRpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHsgcmV0dXJuIGdsb2JhbDsgfVxuXHR0aHJvdyBuZXcgRXJyb3IoJ3VuYWJsZSB0byBsb2NhdGUgZ2xvYmFsIG9iamVjdCcpO1xufVxuXG52YXIgZ2xvYmFsID0gZ2V0R2xvYmFsKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cyA9IGdsb2JhbC5mZXRjaDtcblxuLy8gTmVlZGVkIGZvciBUeXBlU2NyaXB0IGFuZCBXZWJwYWNrLlxuaWYgKGdsb2JhbC5mZXRjaCkge1xuXHRleHBvcnRzLmRlZmF1bHQgPSBnbG9iYWwuZmV0Y2guYmluZChnbG9iYWwpO1xufVxuXG5leHBvcnRzLkhlYWRlcnMgPSBnbG9iYWwuSGVhZGVycztcbmV4cG9ydHMuUmVxdWVzdCA9IGdsb2JhbC5SZXF1ZXN0O1xuZXhwb3J0cy5SZXNwb25zZSA9IGdsb2JhbC5SZXNwb25zZTsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHRpZihfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdKSB7XG5cdFx0cmV0dXJuIF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0uZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsImltcG9ydCAqIGFzIG5vZGVGZXRjaCBmcm9tICdub2RlLWZldGNoJztcbmV4cG9ydCBkZWZhdWx0IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gID8gd2luZG93LmZldGNoLmJpbmQod2luZG93KVxuICA6ICgobm9kZUZldGNoIGFzIHVua25vd24pIGFzIHR5cGVvZiBmZXRjaCk7XG4iLCJpbXBvcnQgeyBBcnJheUZ1bmN0aW9ucyB9IGZyb20gJy4vQHR5cGVzJztcblxuZXhwb3J0IGNvbnN0IGFycmF5RnVuY3Rpb25zOiBBcnJheUZ1bmN0aW9ucyA9IHtcbiAgJGFycmF5Q29tcGFjdDogKGZpZWxkTmFtZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICByZXR1cm4gYEFSUkFZQ09NUEFDVCh7JHtmaWVsZE5hbWV9fSlgO1xuICB9LFxuICAkYXJyYXlGbGF0dGVuOiAoZmllbGROYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIHJldHVybiBgQVJSQVlGTEFUVEVOKHske2ZpZWxkTmFtZX19KWA7XG4gIH0sXG4gICRhcnJheVVuaXF1ZTogKGZpZWxkTmFtZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICByZXR1cm4gYEFSUkFZVU5JUVVFKHske2ZpZWxkTmFtZX19KWA7XG4gIH0sXG4gICRhcnJheUpvaW46IChmaWVsZE5hbWU6IHN0cmluZywgc2VwZXJhdG9yID0gJywnKTogc3RyaW5nID0+IHtcbiAgICByZXR1cm4gYEFSUkFZSk9JTih7JHtmaWVsZE5hbWV9fSwgJyR7c2VwZXJhdG9yfScpYDtcbiAgfSxcbn07XG4iLCJpbXBvcnQgeyBCYXNlRmllbGRUeXBlIH0gZnJvbSAnLi9AdHlwZXMnO1xuXG5leHBvcnQgY29uc3QgYm9vbGVhbkhhbmRsZXIgPSAoYm9vbDogYm9vbGVhbik6IHN0cmluZyA9PiB7XG4gIGlmICh0eXBlb2YgYm9vbCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHR5cGUnKTtcbiAgfVxuICByZXR1cm4gYm9vbCA/ICdUUlVFKCknIDogJ0ZBTFNFKCknO1xufTtcblxuZXhwb3J0IGNvbnN0IGJhc2VIYW5kbGVyID0gKHZhbDogQmFzZUZpZWxkVHlwZSk6IHN0cmluZyA9PiB7XG4gIGlmICh2YWwgPT09IG51bGwpIHtcbiAgICByZXR1cm4gJ0JMQU5LKCknO1xuICB9XG4gIHN3aXRjaCAodHlwZW9mIHZhbCkge1xuICAgIGNhc2UgJ251bWJlcic6XG4gICAgICByZXR1cm4gYCR7dmFsfWA7XG4gICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgIHJldHVybiBgJyR7dmFsfSdgO1xuICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgcmV0dXJuIGJvb2xlYW5IYW5kbGVyKHZhbCk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgVHlwZScpO1xuICB9XG59O1xuIiwiaW1wb3J0IHsgTG9naWNhbEZ1bmN0aW9ucywgUXVlcnlPYmplY3QgfSBmcm9tICcuL0B0eXBlcyc7XG5pbXBvcnQgeyBxdWVyeUJ1aWxkZXIgfSBmcm9tICcuL3F1ZXJ5QnVpbGRlcic7XG5cbmV4cG9ydCBjb25zdCBsb2dpY2FsRnVuY3Rpb25zOiBMb2dpY2FsRnVuY3Rpb25zID0ge1xuICAkbm90OiAoZXhwcmVzc2lvbjogUXVlcnlPYmplY3QpID0+IGBOT1QoJHtxdWVyeUJ1aWxkZXIoZXhwcmVzc2lvbil9KWAsXG4gICRhbmQ6IChhcmdzOiBRdWVyeU9iamVjdFtdKSA9PiBgQU5EKCR7cXVlcnlCdWlsZGVyKGFyZ3MpfSlgLFxuICAkb3I6IChhcmdzOiBRdWVyeU9iamVjdFtdKSA9PiBgT1IoJHtxdWVyeUJ1aWxkZXIoYXJncyl9KWAsXG59O1xuIiwiaW1wb3J0IHsgQ29tcGFyaXNvbk9iamVjdCB9IGZyb20gJy4vQHR5cGVzJztcbmltcG9ydCB7IHF1ZXJ5QnVpbGRlciB9IGZyb20gJy4vcXVlcnlCdWlsZGVyJztcblxuY29uc3Qgb3BlcmF0b3JzID0gWyc9JywgJyE9JywgJz4nLCAnPj0nLCAnPCcsICc8PSddO1xuXG5leHBvcnQgY29uc3QgYnVpbGRFeHByZXNzaW9uID0gKG9iajogQ29tcGFyaXNvbk9iamVjdCwgb3A6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KG9iaikpXG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9yIEludmFsaWQgQ29tcGFyaXNvbiBPYmplY3QnKTtcbiAgaWYgKHR5cGVvZiBvcCAhPT0gJ3N0cmluZycgJiYgIW9wZXJhdG9ycy5pbmNsdWRlcyhvcCkpXG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9yIEludmFsaWQgQ29tcGFyaXNvbiBPcGVyYXRvcicpO1xuICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMob2JqKTtcbiAgY29uc3QgZXhwcmVzc2lvbk1hcHBlciA9IChrOiBzdHJpbmcsIGk6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0IHZhbCA9IHF1ZXJ5QnVpbGRlcihvYmpba10pO1xuICAgIHJldHVybiBgeyR7a319ICR7b3B9ICR7dmFsfSR7aSA8IGtleXMubGVuZ3RoIC0gMSA/ICcsICcgOiAnJ31gO1xuICB9O1xuXG4gIGNvbnN0IGV4cCA9IGAke2tleXMubWFwKGV4cHJlc3Npb25NYXBwZXIpLmpvaW4oJycpfWA7XG4gIHJldHVybiBrZXlzLmxlbmd0aCA+IDEgPyBgQU5EKCR7ZXhwfSlgIDogZXhwO1xufTtcbiIsImltcG9ydCB7IExvZ2ljYWxPcGVyYXRvcnMgfSBmcm9tICcuL0B0eXBlcyc7XG5pbXBvcnQgeyBidWlsZEV4cHJlc3Npb24gfSBmcm9tICcuL2J1aWxkRXhwcmVzc2lvbic7XG5cbmV4cG9ydCBjb25zdCBsb2dpY2FsT3BlcmF0b3JzOiBMb2dpY2FsT3BlcmF0b3JzID0ge1xuICAkZ3Q6ICh2YWwpID0+IHtcbiAgICByZXR1cm4gYnVpbGRFeHByZXNzaW9uKHZhbCwgJz4nKTtcbiAgfSxcbiAgJGx0OiAodmFsKSA9PiB7XG4gICAgcmV0dXJuIGJ1aWxkRXhwcmVzc2lvbih2YWwsICc8Jyk7XG4gIH0sXG4gICRndGU6ICh2YWwpID0+IHtcbiAgICByZXR1cm4gYnVpbGRFeHByZXNzaW9uKHZhbCwgJz49Jyk7XG4gIH0sXG4gICRsdGU6ICh2YWwpID0+IHtcbiAgICByZXR1cm4gYnVpbGRFeHByZXNzaW9uKHZhbCwgJzw9Jyk7XG4gIH0sXG4gICRlcTogKHZhbCkgPT4ge1xuICAgIHJldHVybiBidWlsZEV4cHJlc3Npb24odmFsLCAnPScpO1xuICB9LFxuICAkbmVxOiAodmFsKSA9PiB7XG4gICAgcmV0dXJuIGJ1aWxkRXhwcmVzc2lvbih2YWwsICchPScpO1xuICB9LFxufTtcbiIsImltcG9ydCB7IEZpZWxkTmFtZU9iamVjdCwgUXVlcnlPYmplY3QsIFRleHRGdW5jdGlvbnMgfSBmcm9tICcuL0B0eXBlcyc7XG5pbXBvcnQgeyBiYXNlSGFuZGxlciB9IGZyb20gJy4vYmFzZUhhbmRsZXJzJztcbmltcG9ydCB7IHF1ZXJ5QnVpbGRlciB9IGZyb20gJy4vcXVlcnlCdWlsZGVyJztcblxuZXhwb3J0IGNvbnN0IHRleHRGdW5jdGlvbnM6IFRleHRGdW5jdGlvbnMgPSB7XG4gICR0ZXh0RmluZDogKFxuICAgIHNlYXJjaDogRmllbGROYW1lT2JqZWN0IHwgc3RyaW5nIHwgUXVlcnlPYmplY3QsXG4gICAgc2V0OiBGaWVsZE5hbWVPYmplY3QgfCBzdHJpbmcgfCBRdWVyeU9iamVjdCxcbiAgICBzdGFydEluZGV4ID0gMCxcbiAgKTogc3RyaW5nID0+XG4gICAgYEZJTkQoJHtcbiAgICAgIHR5cGVvZiBzZWFyY2ggPT09ICdzdHJpbmcnID8gYmFzZUhhbmRsZXIoc2VhcmNoKSA6IHF1ZXJ5QnVpbGRlcihzZWFyY2gpXG4gICAgfSwgJHtcbiAgICAgIHR5cGVvZiBzZXQgPT09ICdzdHJpbmcnID8gYmFzZUhhbmRsZXIoc2V0KSA6IHF1ZXJ5QnVpbGRlcihzZXQpXG4gICAgfSwgJHtzdGFydEluZGV4fSlgLFxuICAkdGV4dFNlYXJjaDogKFxuICAgIHNlYXJjaDogRmllbGROYW1lT2JqZWN0IHwgc3RyaW5nIHwgUXVlcnlPYmplY3QsXG4gICAgc2V0OiBGaWVsZE5hbWVPYmplY3QgfCBzdHJpbmcgfCBRdWVyeU9iamVjdCxcbiAgICBzdGFydEluZGV4ID0gMCxcbiAgKTogc3RyaW5nID0+XG4gICAgYFNFQVJDSCgke1xuICAgICAgdHlwZW9mIHNlYXJjaCA9PT0gJ3N0cmluZycgPyBiYXNlSGFuZGxlcihzZWFyY2gpIDogcXVlcnlCdWlsZGVyKHNlYXJjaClcbiAgICB9LCAke1xuICAgICAgdHlwZW9mIHNldCA9PT0gJ3N0cmluZycgPyBiYXNlSGFuZGxlcihzZXQpIDogcXVlcnlCdWlsZGVyKHNldClcbiAgICB9LCAke3N0YXJ0SW5kZXh9KWAsXG59O1xuIiwiaW1wb3J0IHtcbiAgUXVlcnlPYmplY3QsXG4gIFF1ZXJ5RmllbGQsXG4gIEpvaW5BcmdzLFxuICBUZXh0QXJncyxcbiAgRmllbGROYW1lT2JqZWN0LFxuICBVbmNoZWNrZWRBcnJheSxcbiAgQmFzZUZpZWxkVHlwZSxcbn0gZnJvbSAnLi9AdHlwZXMnO1xuXG5leHBvcnQgY29uc3QgaXNRdWVyeU9iamVjdCA9IChpdGVtOiBRdWVyeUZpZWxkKTogaXRlbSBpcyBRdWVyeU9iamVjdCA9PiB7XG4gIGlmIChpdGVtID09PSB1bmRlZmluZWQpIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBRdWVyeSBPYmplY3QnKTtcbiAgcmV0dXJuIGl0ZW0gIT09IG51bGwgJiYgaXRlbSBpbnN0YW5jZW9mIE9iamVjdCAmJiAhQXJyYXkuaXNBcnJheShpdGVtKTtcbn07XG5cbmV4cG9ydCBjb25zdCBpc1F1ZXJ5T2JqZWN0QXJyYXkgPSAoYXJyOiBRdWVyeUZpZWxkKTogYXJyIGlzIFF1ZXJ5T2JqZWN0W10gPT5cbiAgYXJyIGluc3RhbmNlb2YgQXJyYXkgJiYgYXJyLmV2ZXJ5KCh2OiBRdWVyeUZpZWxkKSA9PiBpc1F1ZXJ5T2JqZWN0KHYpKTtcblxuZXhwb3J0IGNvbnN0IGlzU3RyaW5nQXJyYXkgPSAoYXJyOiBRdWVyeUZpZWxkKTogYXJyIGlzIHN0cmluZ1tdID0+XG4gIGFyciBpbnN0YW5jZW9mIEFycmF5ICYmIGFyci5ldmVyeSgodjogUXVlcnlGaWVsZCkgPT4gdHlwZW9mIHYgPT09ICdzdHJpbmcnKTtcblxuZXhwb3J0IGNvbnN0IGlzSm9pbkFyZ3MgPSAoYXJyOiBzdHJpbmdbXSk6IGFyciBpcyBKb2luQXJncyA9PlxuICBpc1N0cmluZ0FycmF5KGFycikgJiYgYXJyLmxlbmd0aCA9PT0gMjtcblxuZXhwb3J0IGNvbnN0IGlzU3RyaW5nT3JGaWVsZE5hbWVPYmplY3QgPSAoXG4gIHZhbDogUXVlcnlGaWVsZCxcbik6IHZhbCBpcyBzdHJpbmcgfCBGaWVsZE5hbWVPYmplY3QgPT5cbiAgdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycgfHxcbiAgKHZhbCBpbnN0YW5jZW9mIE9iamVjdCAmJlxuICAgICFBcnJheS5pc0FycmF5KHZhbCkgJiZcbiAgICB0eXBlb2YgdmFsPy4kZmllbGROYW1lID09PSAnc3RyaW5nJyk7XG5cbmV4cG9ydCBjb25zdCBpc1RleHRBcmdzID0gKGFycjogUXVlcnlGaWVsZFtdKTogYXJyIGlzIFRleHRBcmdzID0+XG4gIGFyciBpbnN0YW5jZW9mIEFycmF5ICYmXG4gICgoYXJyLmxlbmd0aCA9PT0gMyAmJiB0eXBlb2YgYXJyWzJdID09PSAnbnVtYmVyJykgfHxcbiAgICAoYXJyLmxlbmd0aCA9PT0gMiAmJlxuICAgICAgKGlzU3RyaW5nT3JGaWVsZE5hbWVPYmplY3QoYXJyWzBdKSB8fCBpc1F1ZXJ5T2JqZWN0KGFyclswXSkpICYmXG4gICAgICAoaXNTdHJpbmdPckZpZWxkTmFtZU9iamVjdChhcnJbMV0pIHx8IGlzUXVlcnlPYmplY3QoYXJyWzFdKSkpKTtcblxuZXhwb3J0IGNvbnN0IGFsbEluZGV4ZXNWYWxpZCA9IChhcnI6IFVuY2hlY2tlZEFycmF5KTogYXJyIGlzIFF1ZXJ5RmllbGRbXSA9PlxuICBhcnIuZXZlcnkoKGUpID0+IGUgIT09IHVuZGVmaW5lZCAmJiBlICE9PSBudWxsKTtcblxuZXhwb3J0IGNvbnN0IGlzQmFzZUZpZWxkID0gKGl0ZW06IFF1ZXJ5RmllbGQpOiBpdGVtIGlzIEJhc2VGaWVsZFR5cGUgPT5cbiAgdHlwZW9mIGl0ZW0gIT09ICdvYmplY3QnIHx8IGl0ZW0gPT09IG51bGw7XG4iLCJpbXBvcnQgeyBRdWVyeUZpZWxkLCBRdWVyeU9iamVjdCB9IGZyb20gJy4vQHR5cGVzJztcbmltcG9ydCB7IGFycmF5RnVuY3Rpb25zIH0gZnJvbSAnLi9hcnJheUZ1bmN0aW9ucyc7XG5pbXBvcnQgeyBiYXNlSGFuZGxlciB9IGZyb20gJy4vYmFzZUhhbmRsZXJzJztcbmltcG9ydCB7IGxvZ2ljYWxGdW5jdGlvbnMgfSBmcm9tICcuL2xvZ2ljYWxGdW5jdGlvbnMnO1xuaW1wb3J0IHsgbG9naWNhbE9wZXJhdG9ycyB9IGZyb20gJy4vbG9naWNhbE9wZXJhdG9ycyc7XG5pbXBvcnQgeyB0ZXh0RnVuY3Rpb25zIH0gZnJvbSAnLi90ZXh0RnVuY3Rpb25zJztcbmltcG9ydCB7XG4gIGFsbEluZGV4ZXNWYWxpZCxcbiAgaXNCYXNlRmllbGQsXG4gIGlzSm9pbkFyZ3MsXG4gIGlzUXVlcnlPYmplY3QsXG4gIGlzUXVlcnlPYmplY3RBcnJheSxcbiAgaXNTdHJpbmdBcnJheSxcbiAgaXNUZXh0QXJncyxcbn0gZnJvbSAnLi90eXBlQ2hlY2tlcnMnO1xuXG5leHBvcnQgY29uc3QgcXVlcnlCdWlsZGVyID0gKGFyZzogUXVlcnlGaWVsZCk6IHN0cmluZyA9PiB7XG4gIGlmIChhcmcgIT09IHVuZGVmaW5lZCAmJiAhKGFyZyBpbnN0YW5jZW9mIEZ1bmN0aW9uKSkge1xuICAgIGlmIChpc0Jhc2VGaWVsZChhcmcpKSB7XG4gICAgICByZXR1cm4gYmFzZUhhbmRsZXIoYXJnKTtcbiAgICB9XG5cbiAgICBpZiAoYXJnIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgIGNvbnN0IHN0ciA9IGFyZy5tYXAoKGE6IFF1ZXJ5RmllbGQpID0+IHF1ZXJ5QnVpbGRlcihhKSkuam9pbignLCAnKTtcbiAgICAgIHJldHVybiBzdHIudHJpbSgpO1xuICAgIH1cblxuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhhcmcpO1xuICAgIGNvbnN0IHZhbHMgPSBPYmplY3QudmFsdWVzKGFyZyk7XG5cbiAgICBpZiAoXG4gICAgICBrZXlzLmxlbmd0aCA+IDEgJiZcbiAgICAgIGFsbEluZGV4ZXNWYWxpZCh2YWxzKSAmJlxuICAgICAgaXNRdWVyeU9iamVjdEFycmF5KGtleXMubWFwKChrLCBpKSA9PiAoeyBba106IHZhbHNbaV0gfSkpKVxuICAgICkge1xuICAgICAgcmV0dXJuIGxvZ2ljYWxGdW5jdGlvbnMuJGFuZChcbiAgICAgICAga2V5cy5tYXAoKGssIGkpID0+ICh7IFtrXTogdmFsc1tpXSB9KSkgYXMgUXVlcnlPYmplY3QgJiBRdWVyeU9iamVjdFtdLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBrZXkgPSBrZXlzWzBdO1xuXG4gICAgaWYgKGFyZ1trZXldID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBxdWVyeScpO1xuICAgIH1cblxuICAgIGlmIChrZXkgPT09ICckZmllbGROYW1lJykge1xuICAgICAgcmV0dXJuIGB7JHthcmcuJGZpZWxkTmFtZX19YDtcbiAgICB9XG5cbiAgICBjb25zdCB2YWwgPSBhcmdba2V5XSBhcyBRdWVyeUZpZWxkO1xuICAgIGlmICh2YWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKFxuICAgICAgICBrZXkgaW4gbG9naWNhbEZ1bmN0aW9ucyAmJlxuICAgICAgICAoaXNRdWVyeU9iamVjdCh2YWwpIHx8IGlzUXVlcnlPYmplY3RBcnJheSh2YWwpKVxuICAgICAgKSB7XG4gICAgICAgIHJldHVybiBsb2dpY2FsRnVuY3Rpb25zW2tleV0odmFsIGFzIFF1ZXJ5T2JqZWN0ICYgUXVlcnlPYmplY3RbXSk7XG4gICAgICB9IGVsc2UgaWYgKGtleSBpbiBhcnJheUZ1bmN0aW9ucykge1xuICAgICAgICBpZiAoaXNTdHJpbmdBcnJheSh2YWwpICYmIGlzSm9pbkFyZ3ModmFsKSkge1xuICAgICAgICAgIHJldHVybiBhcnJheUZ1bmN0aW9uc1trZXldKC4uLnZhbCk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICByZXR1cm4gYXJyYXlGdW5jdGlvbnNba2V5XSh2YWwpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKFxuICAgICAgICBrZXkgaW4gdGV4dEZ1bmN0aW9ucyAmJlxuICAgICAgICBBcnJheS5pc0FycmF5KHZhbCkgJiZcbiAgICAgICAgaXNUZXh0QXJncyh2YWwpXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIHRleHRGdW5jdGlvbnNba2V5XSh2YWxbMF0sIHZhbFsxXSwgdmFsWzJdID8/IDApO1xuICAgICAgfSBlbHNlIGlmIChpc1F1ZXJ5T2JqZWN0KHZhbCkpIHtcbiAgICAgICAgY29uc3QgdmFsS2V5cyA9IE9iamVjdC5rZXlzKHZhbCk7XG4gICAgICAgIGNvbnN0IHN1YlZhbHMgPSBPYmplY3QudmFsdWVzKHZhbCk7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIHZhbEtleXMubGVuZ3RoID4gMSAmJlxuICAgICAgICAgIGFsbEluZGV4ZXNWYWxpZChzdWJWYWxzKSAmJlxuICAgICAgICAgIGlzUXVlcnlPYmplY3RBcnJheSh2YWxLZXlzLm1hcCgoaywgaSkgPT4gKHsgW2tdOiBzdWJWYWxzW2ldIH0pKSkgJiZcbiAgICAgICAgICB2YWxLZXlzLmV2ZXJ5KChrKSA9PiBrIGluIGxvZ2ljYWxPcGVyYXRvcnMpICYmXG4gICAgICAgICAgc3ViVmFscy5ldmVyeSgodikgPT4gaXNRdWVyeU9iamVjdCh2KSB8fCBpc0Jhc2VGaWVsZCh2KSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgcmV0dXJuIGxvZ2ljYWxGdW5jdGlvbnMuJGFuZChcbiAgICAgICAgICAgIHZhbEtleXMubWFwKChrLCBpKSA9PiAoe1xuICAgICAgICAgICAgICBba2V5XTogeyBba106IHN1YlZhbHNbaV0gfSxcbiAgICAgICAgICAgIH0pKSBhcyBRdWVyeU9iamVjdCAmIFF1ZXJ5T2JqZWN0W10sXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZhbEtleSA9IHZhbEtleXNbMF07XG4gICAgICAgIGNvbnN0IHN1YlZhbCA9IHN1YlZhbHNbMF07XG4gICAgICAgIGlmIChcbiAgICAgICAgICB2YWxLZXkgaW4gbG9naWNhbE9wZXJhdG9ycyAmJlxuICAgICAgICAgIChpc1F1ZXJ5T2JqZWN0KHN1YlZhbCkgfHwgaXNCYXNlRmllbGQoc3ViVmFsKSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgcmV0dXJuIGxvZ2ljYWxPcGVyYXRvcnNbdmFsS2V5XSh7XG4gICAgICAgICAgICBba2V5XTogc3ViVmFsLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGlzUXVlcnlPYmplY3QodmFsKSB8fCBpc0Jhc2VGaWVsZCh2YWwpKSB7XG4gICAgICAgIHJldHVybiBsb2dpY2FsT3BlcmF0b3JzLiRlcSh7IFtrZXldOiB2YWwgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBRdWVyeSBPYmplY3QnKTtcbn07XG4iLCJpbXBvcnQgeyBTZWxlY3RPcHRpb25zIH0gZnJvbSAnLi9AdHlwZXMnO1xuaW1wb3J0IHsgcXVlcnlCdWlsZGVyIH0gZnJvbSAnLi9xdWVyeUJ1aWxkZXInO1xuXG5leHBvcnQgZGVmYXVsdCAob3B0czogU2VsZWN0T3B0aW9ucyk6IHN0cmluZyA9PiB7XG4gIGlmIChcbiAgICBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob3B0cywgJ2ZpbHRlckJ5Rm9ybXVsYScpICYmXG4gICAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9wdHMsICd3aGVyZScpXG4gIClcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnQ2Fubm90IHVzZSBib3RoIHdoZXJlIGFuZCBmaWx0ZXJCeUZvcm11bGEgYXMgdGhleSBhY2NvbXBsaXNoIHRoZSBzYW1lIHRoaW5nJyxcbiAgICApO1xuXG4gIGNvbnN0IHBhcmFtcyA9IE9iamVjdC5rZXlzKG9wdHMpXG4gICAgLm1hcCgoa2V5OiBzdHJpbmcsIGkpID0+IHtcbiAgICAgIC8qKiBAdG9kbyBGaW5kIGEgYmV0dGVyIHR5cGUgdGhhbiBhbnkgZm9yIHRoaXMgKi9cbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICBjb25zdCBvcHQ6IGFueSA9IG9wdHNba2V5IGFzIGtleW9mIFNlbGVjdE9wdGlvbnNdO1xuICAgICAgbGV0IGZvcm1hdHRlZDtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KG9wdCkpIHtcbiAgICAgICAgZm9ybWF0dGVkID0gb3B0XG4gICAgICAgICAgLm1hcCgoaXRlbSwgaikgPT4ge1xuICAgICAgICAgICAgc3dpdGNoICh0eXBlb2YgaXRlbSkge1xuICAgICAgICAgICAgICBjYXNlICdvYmplY3QnOlxuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhpdGVtKVxuICAgICAgICAgICAgICAgICAgLm1hcCgoc3ViS2V5KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgJHtrZXl9WyR7an1dWyR7c3ViS2V5fV09JHtpdGVtW3N1YktleV19YDtcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAuam9pbignJicpO1xuICAgICAgICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgICAgIHJldHVybiBgJHtrZXl9W109JHtpdGVtfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuam9pbignJicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGtleSA9PT0gJ3doZXJlJykge1xuICAgICAgICAgIGZvcm1hdHRlZCA9IGBmaWx0ZXJCeUZvcm11bGE9JHtxdWVyeUJ1aWxkZXIob3B0KX1gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvcm1hdHRlZCA9IGAke2tleX09JHtvcHR9YDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGkgIT09IDAgPyBgJiR7Zm9ybWF0dGVkfWAgOiBmb3JtYXR0ZWQ7XG4gICAgfSlcbiAgICAuam9pbignJyk7XG4gIHJldHVybiBlbmNvZGVVUkkocGFyYW1zKTtcbn07XG4iLCJleHBvcnQgZGVmYXVsdCAoc3RhdHVzOiBudW1iZXIpOiBib29sZWFuID0+IHN0YXR1cyA+PSAzMDA7XG4iLCJpbXBvcnQgeyBBcmcgfSBmcm9tICcuL0B0eXBlcyc7XG5cbmV4cG9ydCBkZWZhdWx0IChcbiAgYXJnOiBBcmcsXG4gIG5hbWU6IHN0cmluZyxcbiAgdHlwZTogc3RyaW5nLFxuICByZXF1aXJlZCA9IHRydWUsXG4pOiB2b2lkID0+IHtcbiAgaWYgKGFyZyA9PT0gdW5kZWZpbmVkICYmIHJlcXVpcmVkKVxuICAgIHRocm93IG5ldyBFcnJvcihgQXJndW1lbnQgXCIke25hbWV9XCIgaXMgcmVxdWlyZWQuYCk7XG4gIGlmIChhcmcgPT09IHVuZGVmaW5lZCAmJiAhcmVxdWlyZWQpIHJldHVybjtcbiAgaWYgKHR5cGVvZiBhcmcgIT09IHR5cGUpIHtcbiAgICBpZiAodHlwZSA9PT0gJ2FycmF5JyAmJiBBcnJheS5pc0FycmF5KGFyZykpIHJldHVybjtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgSW5jb3JyZWN0IGRhdGEgdHlwZSBvbiBhcmd1bWVudCBcIiR7bmFtZX1cIi4gUmVjZWl2ZWQgXCIke3R5cGVvZiBhcmd9XCI6IGV4cGVjdGVkIFwiJHt0eXBlfVwiYCxcbiAgICApO1xuICB9XG59O1xuIiwiaW1wb3J0IGZldGNoIGZyb20gJy4vZmV0Y2gnO1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKFxuICB1cmw6IHN0cmluZyxcbiAgb3B0czogUmVxdWVzdEluaXQsXG4gIHJldHJ5VGltZW91dDogbnVtYmVyLFxuICBtYXhSZXRyeTogbnVtYmVyLFxuICBrZXk/OiBzdHJpbmcsXG4gIC8qKiBAdG9kbyBGaW5kIGEgYmV0dGVyIHR5cGUgdGhhbiBhbnkgZm9yIHRoaXMgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbik6IFByb21pc2U8YW55PiA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3QgcmV0cnlSYXRlTGltaXQgPSAoXG4gICAgICB1cmw6IHN0cmluZyxcbiAgICAgIG9wdHM6IFJlcXVlc3RJbml0LFxuICAgICAgcmV0cnlUaW1lb3V0OiBudW1iZXIsXG4gICAgICBtYXhSZXRyeTogbnVtYmVyLFxuICAgICAga2V5Pzogc3RyaW5nLFxuICAgICk6IHZvaWQgPT4ge1xuICAgICAgaWYgKG1heFJldHJ5ICYmIG1heFJldHJ5IDwgMSkge1xuICAgICAgICByZWplY3QoJ01heCB0aW1lb3V0IGV4Y2VlZGVkJyk7XG4gICAgICB9XG4gICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwsIG9wdHMpO1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09PSA0MjkpIHtcbiAgICAgICAgICAgIHJldHVybiByZXRyeVJhdGVMaW1pdChcbiAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICBvcHRzLFxuICAgICAgICAgICAgICByZXRyeVRpbWVvdXQgKiAxLjUsXG4gICAgICAgICAgICAgIG1heFJldHJ5IC0gcmV0cnlUaW1lb3V0LFxuICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICByZXNvbHZlKGRhdGFba2V5XSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuICAgICAgfSwgcmV0cnlUaW1lb3V0KTtcbiAgICB9O1xuXG4gICAgcmV0cnlSYXRlTGltaXQodXJsLCBvcHRzLCByZXRyeVRpbWVvdXQsIG1heFJldHJ5LCBrZXkpO1xuICB9KTtcbn07XG4iLCJpbXBvcnQgZmV0Y2ggZnJvbSAnLi9mZXRjaCc7XG5pbXBvcnQgYnVpbGRPcHRzIGZyb20gJy4vYnVpbGRPcHRzJztcbmltcG9ydCBjaGVja0Vycm9yIGZyb20gJy4vY2hlY2tFcnJvcic7XG5pbXBvcnQgY2hlY2tBcmcgZnJvbSAnLi9jaGVja0FyZyc7XG5pbXBvcnQgcmF0ZUxpbWl0SGFuZGxlciBmcm9tICcuL3JhdGVMaW1pdEhhbmRsZXInO1xuY29uc3QgYmFzZVVSTCA9ICdodHRwczovL2FwaS5haXJ0YWJsZS5jb20vdjAnO1xuaW1wb3J0IHtcbiAgU2VsZWN0T3B0aW9ucyxcbiAgQWlydGFibGVEZWxldGVkUmVzcG9uc2UsXG4gIEFpcnRhYmxlUmVjb3JkLFxuICBBaXJ0YWJsZVJlY29yZFJlc3BvbnNlLFxuICBBaXJ0YWJsZVVwZGF0ZVJlY29yZCxcbiAgRGVsZXRlUmVzcG9uc2UsXG4gIEZpZWxkcyxcbiAgQ29uZmlnLFxuICBxdWVyeUJvZHksXG4gIFR5cGVjYXN0LFxuICB1cGRhdGVPcHRzLFxuICBidWxrUXVlcnlCb2R5LFxufSBmcm9tICcuL0B0eXBlcyc7XG5cbi8qKiBAaWdub3JlICovXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBXaW5kb3cge1xuICAgIEFzeW5jQWlydGFibGU6IHR5cGVvZiBBc3luY0FpcnRhYmxlO1xuICB9XG59XG5cbmNvbnN0IHZhbGlkT3B0aW9uczogc3RyaW5nW10gPSBbXG4gICdmaWVsZHMnLFxuICAnZmlsdGVyQnlGb3JtdWxhJyxcbiAgJ21heFJlY29yZHMnLFxuICAncGFnZVNpemUnLFxuICAnc29ydCcsXG4gICd2aWV3JyxcbiAgJ3doZXJlJyxcbl07XG5cbi8qKlxuICogVGhlIG1haW4gQXN5bmNBaXJ0YWJsZSBjbGFzcy5cbiAqL1xuZXhwb3J0IGNsYXNzIEFzeW5jQWlydGFibGUge1xuICAvKipcbiAgICogQGRlZmF1bHQ9dHJ1ZVxuICAgKiBUaGlzIGRlY2lkZXMgd2hldGhlciBvciBub3QgdGhlIGxpYnJhcnkgd2lsbFxuICAgKiBoYW5kbGUgcmV0cnlpbmcgYSByZXF1ZXN0IHdoZW4gcmF0ZSBsaW1pdGVkXG4gICAqL1xuICByZXRyeU9uUmF0ZUxpbWl0OiBib29sZWFuO1xuICAvKipcbiAgICogQGRlZmF1bHQ9NjAwMDBcbiAgICogVGhlIG1heG1pdW0gYW1vdW50IG9mIHRpbWUgYmVmb3JlIHRoZVxuICAgKiBsaWJyYXJ5IHdpbGwgc3RvcCByZXRyeWluZyBhbmQgdGltZW91dCB3aGVuIHJhdGUgbGltaXRlZFxuICAgKi9cbiAgbWF4UmV0cnk6IG51bWJlcjtcbiAgLyoqXG4gICAqIEBkZWZhdWx0PTUwMDBcbiAgICogVGhlIHN0YXJ0aW5nIHRpbWVvdXQgZm9yIHRoZSByZXRyeS4gVGhpcyB3aWxsIGdldCA1MCVcbiAgICogbGFyZ2VyIHdpdGggZWFjaCB0cnkgdW50aWwgeW91IGhpdCB0aGUgbWF4UmV0cnkgYW1vdW50XG4gICAqL1xuICByZXRyeVRpbWVvdXQ6IG51bWJlcjtcbiAgLyoqIFRoZSBBUEkgS2V5IGZyb20gQWlyVGFibGUgKi9cbiAgYXBpS2V5OiBzdHJpbmc7XG4gIC8qKiBUaGUgYmFzZSBpZCBmcm9tIEFpclRhYmxlICovXG4gIGJhc2U6IHN0cmluZztcblxuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgQXN5bmNBaXJ0YWJsZSBsaWJyYXJ5LlxuICAgKiBAcGFyYW0gYXBpS2V5IFRoZSBBUEkgS2V5IGZyb20gQWlyVGFibGVcbiAgICogQHBhcmFtIGJhc2UgVGhlIGJhc2UgaWQgZnJvbSBBaXJUYWJsZVxuICAgKiBAcGFyYW0gY29uZmlnIFRoZSBjb25maWcgdG8gdXNlIGZvciB0aGlzIGluc3RhbmNlIG9mIEFzeW5jQWlydGFibGVcbiAgICovXG4gIGNvbnN0cnVjdG9yKGFwaUtleTogc3RyaW5nLCBiYXNlOiBzdHJpbmcsIGNvbmZpZz86IENvbmZpZykge1xuICAgIGlmICghYXBpS2V5KSB0aHJvdyBuZXcgRXJyb3IoJ0FQSSBLZXkgaXMgcmVxdWlyZWQuJyk7XG4gICAgaWYgKCFiYXNlKSB0aHJvdyBuZXcgRXJyb3IoJ0Jhc2UgSUQgaXMgcmVxdWlyZWQuJyk7XG4gICAgdGhpcy5hcGlLZXkgPSBhcGlLZXk7XG4gICAgdGhpcy5iYXNlID0gYmFzZTtcbiAgICB0aGlzLnJldHJ5T25SYXRlTGltaXQgPSBjb25maWc/LnJldHJ5T25SYXRlTGltaXQgfHwgdHJ1ZTtcbiAgICB0aGlzLnJldHJ5VGltZW91dCA9IGNvbmZpZz8ucmV0cnlUaW1lb3V0IHx8IDUwMDA7XG4gICAgdGhpcy5tYXhSZXRyeSA9IGNvbmZpZz8ubWF4UmV0cnkgfHwgNjAwMDA7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IHJlY29yZChzKSBmcm9tIHRoZSBzcGVjaWZpZWQgdGFibGUuXG4gICAqIEBwYXJhbSB0YWJsZSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbnMgb2JqZWN0LCB1c2VkIHRvIGZpbHRlciByZWNvcmRzXG4gICAqIEBwYXJhbSBwYWdlIFVzZWQgdG8gZ2V0IGEgc3BlY2lmaWMgcGFnZSBvZiByZWNvcmRzXG4gICAqIEByZXR1cm5zXG4gICAqIEBhc3luY1xuICAgKi9cbiAgc2VsZWN0ID0gYXN5bmMgKFxuICAgIHRhYmxlOiBzdHJpbmcsXG4gICAgb3B0aW9ucz86IFNlbGVjdE9wdGlvbnMsXG4gICAgcGFnZT86IG51bWJlcixcbiAgKTogUHJvbWlzZTxBaXJ0YWJsZVJlY29yZFtdPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrQXJnKHRhYmxlLCAndGFibGUnLCAnc3RyaW5nJyk7XG4gICAgICBjaGVja0FyZyhvcHRpb25zLCAnb3B0aW9ucycsICdvYmplY3QnLCBmYWxzZSk7XG4gICAgICBjaGVja0FyZyhwYWdlLCAncGFnZScsICdudW1iZXInLCBmYWxzZSk7XG4gICAgICBjb25zdCB1cmwgPSBgJHtiYXNlVVJMfS8ke3RoaXMuYmFzZX0vJHt0YWJsZX1gO1xuICAgICAgY29uc3Qgb3B0czogU2VsZWN0T3B0aW9ucyA9IG9wdGlvbnMgPyB7IC4uLm9wdGlvbnMgfSA6IHt9O1xuICAgICAgT2JqZWN0LmtleXMob3B0cykuZm9yRWFjaCgob3B0aW9uKSA9PiB7XG4gICAgICAgIGlmICghdmFsaWRPcHRpb25zLmluY2x1ZGVzKG9wdGlvbikpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgb3B0aW9uOiAke29wdGlvbn1gKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBsZXQgb2Zmc2V0OiBzdHJpbmcgfCB1bmRlZmluZWQgPSAnJztcbiAgICAgIGxldCBkYXRhOiBBaXJ0YWJsZVJlY29yZFtdID0gW107XG4gICAgICBpZiAocGFnZSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZ2U7IGkrKykge1xuICAgICAgICAgIGlmIChvZmZzZXQpIHtcbiAgICAgICAgICAgIG9wdHMub2Zmc2V0ID0gb2Zmc2V0O1xuICAgICAgICAgIH1cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzOiBSZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3VybH0/JHtidWlsZE9wdHMob3B0cyl9YCwge1xuICAgICAgICAgICAgICBoZWFkZXJzOiB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGJvZHk6IEFpcnRhYmxlUmVjb3JkUmVzcG9uc2UgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgICAgaWYgKGNoZWNrRXJyb3IocmVzLnN0YXR1cykpIHtcbiAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDQyOSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihKU09OLnN0cmluZ2lmeShib2R5KSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAodGhpcy5yZXRyeU9uUmF0ZUxpbWl0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgKyAxID09PSBwYWdlKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgcmF0ZUxpbWl0SGFuZGxlcihcbiAgICAgICAgICAgICAgICAgICAgYCR7dXJsfT8ke2J1aWxkT3B0cyhvcHRzKX1gLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJldHJ5VGltZW91dCxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXhSZXRyeSxcbiAgICAgICAgICAgICAgICAgICAgJ3JlY29yZHMnLFxuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpICsgMSA9PT0gcGFnZSkge1xuICAgICAgICAgICAgICByZXR1cm4gYm9keS5yZWNvcmRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2Zmc2V0ID0gYm9keS5vZmZzZXQ7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBkb25lID0gZmFsc2U7XG4gICAgICAgIHdoaWxlICghZG9uZSkge1xuICAgICAgICAgIGlmIChvZmZzZXQpIHtcbiAgICAgICAgICAgIG9wdHMub2Zmc2V0ID0gb2Zmc2V0O1xuICAgICAgICAgIH1cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzOiBSZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3VybH0/JHtidWlsZE9wdHMob3B0cyl9YCwge1xuICAgICAgICAgICAgICBoZWFkZXJzOiB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGJvZHk6IEFpcnRhYmxlUmVjb3JkUmVzcG9uc2UgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgICAgaWYgKGNoZWNrRXJyb3IocmVzLnN0YXR1cykpIHtcbiAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDQyOSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihKU09OLnN0cmluZ2lmeShib2R5KSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAodGhpcy5yZXRyeU9uUmF0ZUxpbWl0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHJhdGVMaW1pdEhhbmRsZXIoXG4gICAgICAgICAgICAgICAgICBgJHt1cmx9PyR7YnVpbGRPcHRzKG9wdHMpfWAsXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAgfSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB0aGlzLnJldHJ5VGltZW91dCxcbiAgICAgICAgICAgICAgICAgIHRoaXMubWF4UmV0cnksXG4gICAgICAgICAgICAgICAgICAncmVjb3JkcycsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YSA9IGRhdGEuY29uY2F0KGJvZHkucmVjb3Jkcyk7XG4gICAgICAgICAgICBvZmZzZXQgPSBib2R5Lm9mZnNldDtcbiAgICAgICAgICAgIGlmICghYm9keS5vZmZzZXQpIHtcbiAgICAgICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBGaW5kcyBhIHJlY29yZCBvbiB0aGUgc3BlY2lmaWVkIHRhYmxlLlxuICAgKiBAcGFyYW0gdGFibGUgVGFibGUgbmFtZVxuICAgKiBAcGFyYW0gaWQgQWlydGFibGUgcmVjb3JkIElEXG4gICAqIEByZXR1cm5zXG4gICAqIEBhc3luY1xuICAgKi9cbiAgZmluZCA9IGFzeW5jICh0YWJsZTogc3RyaW5nLCBpZDogc3RyaW5nKTogUHJvbWlzZTxBaXJ0YWJsZVJlY29yZD4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBjaGVja0FyZyh0YWJsZSwgJ3RhYmxlJywgJ3N0cmluZycpO1xuICAgICAgY2hlY2tBcmcoaWQsICdpZCcsICdzdHJpbmcnKTtcbiAgICAgIGNvbnN0IHVybCA9IGAke2Jhc2VVUkx9LyR7dGhpcy5iYXNlfS8ke3RhYmxlfS8ke2lkfWA7XG4gICAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIGhlYWRlcnM6IHsgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAgfSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgZGF0YTogQWlydGFibGVSZWNvcmQgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgaWYgKGNoZWNrRXJyb3IocmVzLnN0YXR1cykpIHtcbiAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDQyOSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5yZXRyeU9uUmF0ZUxpbWl0KSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHJhdGVMaW1pdEhhbmRsZXIoXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGhlYWRlcnM6IHsgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aGlzLnJldHJ5VGltZW91dCxcbiAgICAgICAgICAgIHRoaXMubWF4UmV0cnksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgcmVjb3JkIG9uIHRoZSBzcGVjaWZpZWQgdGFibGUuXG4gICAqIEBwYXJhbSB0YWJsZSAtIFRhYmxlIG5hbWVcbiAgICogQHBhcmFtIHJlY29yZCAtIFJlY29yZCBvYmplY3QsIHVzZWQgdG8gc3RydWN0dXJlIGRhdGEgZm9yIGluc2VydFxuICAgKiBAcGFyYW0gdHlwZWNhc3QgLSBVc2VkIGZvciBhbGxvd2luZyB0aGUgYWJpbGl0eSB0byBhZGQgbmV3IHNlbGVjdGlvbnMgZm9yIFNlbGVjdCBhbmQgTXVsdGlzZWxlY3QgZmllbGRzLlxuICAgKiBAcmV0dXJuc1xuICAgKiBAYXN5bmNcbiAgICovXG4gIGNyZWF0ZVJlY29yZCA9IGFzeW5jIChcbiAgICB0YWJsZTogc3RyaW5nLFxuICAgIHJlY29yZDogRmllbGRzLFxuICAgIHR5cGVjYXN0PzogVHlwZWNhc3QsXG4gICk6IFByb21pc2U8QWlydGFibGVSZWNvcmQ+ID0+IHtcbiAgICB0cnkge1xuICAgICAgY2hlY2tBcmcodGFibGUsICd0YWJsZScsICdzdHJpbmcnKTtcbiAgICAgIGNoZWNrQXJnKHJlY29yZCwgJ3JlY29yZCcsICdvYmplY3QnKTtcbiAgICAgIGNoZWNrQXJnKHR5cGVjYXN0LCAndHlwZWNhc3QnLCAnYm9vbGVhbicsIGZhbHNlKTtcbiAgICAgIGNvbnN0IHVybCA9IGAke2Jhc2VVUkx9LyR7dGhpcy5iYXNlfS8ke3RhYmxlfWA7XG4gICAgICBjb25zdCBib2R5OiBxdWVyeUJvZHkgPSB7IGZpZWxkczogcmVjb3JkIH07XG4gICAgICBpZiAodHlwZWNhc3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBib2R5LnR5cGVjYXN0ID0gdHlwZWNhc3Q7XG4gICAgICB9XG4gICAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGRhdGE6IEFpcnRhYmxlUmVjb3JkID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgIGlmIChjaGVja0Vycm9yKHJlcy5zdGF0dXMpKSB7XG4gICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSA0MjkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmV0cnlPblJhdGVMaW1pdCkge1xuICAgICAgICAgIHJldHVybiBhd2FpdCByYXRlTGltaXRIYW5kbGVyKFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXMucmV0cnlUaW1lb3V0LFxuICAgICAgICAgICAgdGhpcy5tYXhSZXRyeSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnIpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogVXBkYXRlcyBhIHJlY29yZCBvbiB0aGUgc3BlY2lmaWVkIHRhYmxlLlxuICAgKiBAcGFyYW0gdGFibGUgLSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSByZWNvcmQgLSBSZWNvcmQgb2JqZWN0LCB1c2VkIHRvIHVwZGF0ZSBkYXRhIHdpdGhpbiBhIHNwZWNpZmljIHJlY29yZFxuICAgKiBAcGFyYW0gb3B0cyAtIEFuIG9iamVjdCB3aXRoIG9wdGlvbnMgZm9yIHlvdXIgdXBkYXRlIHN0YXRlbWVudFxuICAgKiBAcmV0dXJuc1xuICAgKiBAYXN5bmNcbiAgICovXG4gIHVwZGF0ZVJlY29yZCA9IGFzeW5jIChcbiAgICB0YWJsZTogc3RyaW5nLFxuICAgIHJlY29yZDogQWlydGFibGVVcGRhdGVSZWNvcmQsXG4gICAgb3B0cz86IHVwZGF0ZU9wdHMsXG4gICk6IFByb21pc2U8QWlydGFibGVSZWNvcmQ+ID0+IHtcbiAgICB0cnkge1xuICAgICAgY2hlY2tBcmcodGFibGUsICd0YWJsZScsICdzdHJpbmcnKTtcbiAgICAgIGNoZWNrQXJnKHJlY29yZCwgJ3JlY29yZCcsICdvYmplY3QnKTtcbiAgICAgIGlmIChvcHRzKSB7XG4gICAgICAgIGNoZWNrQXJnKG9wdHMuZGVzdHJ1Y3RpdmUsICdvcHRzLmRlc2N0cnVjdGl2ZScsICdib29sZWFuJyk7XG4gICAgICAgIGNoZWNrQXJnKG9wdHMudHlwZWNhc3QsICdvcHRzLnR5cGVjYXN0JywgJ2Jvb2xlYW4nLCBmYWxzZSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1cmwgPSBgJHtiYXNlVVJMfS8ke3RoaXMuYmFzZX0vJHt0YWJsZX0vJHtyZWNvcmQuaWR9YDtcbiAgICAgIGNvbnN0IGJvZHk6IHF1ZXJ5Qm9keSA9IHsgZmllbGRzOiByZWNvcmQuZmllbGRzIH07XG4gICAgICBpZiAob3B0cz8udHlwZWNhc3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBib2R5LnR5cGVjYXN0ID0gb3B0cz8udHlwZWNhc3Q7XG4gICAgICB9XG4gICAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogb3B0cz8uZGVzdHJ1Y3RpdmUgPyAncHV0JyA6ICdwYXRjaCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgZGF0YTogQWlydGFibGVSZWNvcmQgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgaWYgKGNoZWNrRXJyb3IocmVzLnN0YXR1cykpIHtcbiAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDQyOSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5yZXRyeU9uUmF0ZUxpbWl0KSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHJhdGVMaW1pdEhhbmRsZXIoXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIG1ldGhvZDogb3B0cz8uZGVzdHJ1Y3RpdmUgPyAncHV0JyA6ICdwYXRjaCcsXG4gICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aGlzLnJldHJ5VGltZW91dCxcbiAgICAgICAgICAgIHRoaXMubWF4UmV0cnksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIERlbGV0ZXMgYSByZWNvcmQgZnJvbSB0aGUgc3BlY2lmaWVkIHRhYmxlLlxuICAgKiBAcGFyYW0gdGFibGUgLSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSBpZCAtIEFpcnRhYmxlIHJlY29yZCBJRFxuICAgKiBAcmV0dXJuc1xuICAgKiBAYXN5bmNcbiAgICovXG4gIGRlbGV0ZVJlY29yZCA9IGFzeW5jICh0YWJsZTogc3RyaW5nLCBpZDogc3RyaW5nKTogUHJvbWlzZTxEZWxldGVSZXNwb25zZT4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBjaGVja0FyZyh0YWJsZSwgJ3RhYmxlJywgJ3N0cmluZycpO1xuICAgICAgY2hlY2tBcmcoaWQsICdpZCcsICdzdHJpbmcnKTtcbiAgICAgIGNvbnN0IHVybCA9IGAke2Jhc2VVUkx9LyR7dGhpcy5iYXNlfS8ke3RhYmxlfS8ke2lkfWA7XG4gICAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgZGF0YTogRGVsZXRlUmVzcG9uc2UgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgaWYgKGNoZWNrRXJyb3IocmVzLnN0YXR1cykpIHtcbiAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDQyOSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5yZXRyeU9uUmF0ZUxpbWl0KSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHJhdGVMaW1pdEhhbmRsZXIoXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aGlzLnJldHJ5VGltZW91dCxcbiAgICAgICAgICAgIHRoaXMubWF4UmV0cnksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgbXVsdGlwbGUgbmV3IHJlY29yZHMgb24gdGhlIHNwZWNpZmllZCB0YWJsZS5cbiAgICogQHBhcmFtIHRhYmxlIC0gVGFibGUgbmFtZVxuICAgKiBAcGFyYW0gcmVjb3JkcyAtIEFuIGFycmF5IG9mIFJlY29yZCBvYmplY3RzXG4gICAqIEBwYXJhbSB0eXBlY2FzdCAtIFVzZWQgZm9yIGFsbG93aW5nIHRoZSBhYmlsaXR5IHRvIGFkZCBuZXcgc2VsZWN0aW9ucyBmb3IgU2VsZWN0IGFuZCBNdWx0aXNlbGVjdCBmaWVsZHMuXG4gICAqIEByZXR1cm5zXG4gICAqIEBhc3luY1xuICAgKi9cbiAgYnVsa0NyZWF0ZSA9IGFzeW5jIChcbiAgICB0YWJsZTogc3RyaW5nLFxuICAgIHJlY29yZHM6IEZpZWxkc1tdLFxuICAgIHR5cGVjYXN0PzogVHlwZWNhc3QsXG4gICk6IFByb21pc2U8QWlydGFibGVSZWNvcmRbXT4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBjaGVja0FyZyh0YWJsZSwgJ3RhYmxlJywgJ3N0cmluZycpO1xuICAgICAgY2hlY2tBcmcocmVjb3JkcywgJ3JlY29yZHMnLCAnYXJyYXknKTtcbiAgICAgIGNoZWNrQXJnKHR5cGVjYXN0LCAndHlwZWNhc3QnLCAnYm9vbGVhbicsIGZhbHNlKTtcbiAgICAgIGNvbnN0IHVybCA9IGAke2Jhc2VVUkx9LyR7dGhpcy5iYXNlfS8ke3RhYmxlfWA7XG4gICAgICBjb25zdCBib2R5OiBidWxrUXVlcnlCb2R5ID0ge1xuICAgICAgICByZWNvcmRzOiByZWNvcmRzLm1hcCgocmVjb3JkKSA9PiAoe1xuICAgICAgICAgIGZpZWxkczogcmVjb3JkLFxuICAgICAgICB9KSksXG4gICAgICB9O1xuICAgICAgaWYgKHR5cGVjYXN0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgYm9keS50eXBlY2FzdCA9IHR5cGVjYXN0O1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzOiBSZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBjb25zdCBkYXRhOiBBaXJ0YWJsZVJlY29yZFJlc3BvbnNlID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgIGlmIChjaGVja0Vycm9yKHJlcy5zdGF0dXMpKSB7XG4gICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSA0MjkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmV0cnlPblJhdGVMaW1pdCkge1xuICAgICAgICAgIHJldHVybiBhd2FpdCByYXRlTGltaXRIYW5kbGVyKFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXMucmV0cnlUaW1lb3V0LFxuICAgICAgICAgICAgdGhpcy5tYXhSZXRyeSxcbiAgICAgICAgICAgICdyZWNvcmRzJyxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YS5yZWNvcmRzO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIG11bHRpcGxlIHJlY29yZHMgb24gdGhlIHNwZWNpZmllZCB0YWJsZVxuICAgKiBAcGFyYW0gdGFibGUgLSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSByZWNvcmRzIC0gQW4gYXJyYXkgb2YgUmVjb3JkIG9iamVjdHNcbiAgICogQHBhcmFtIG9wdHMgLSBBbiBvYmplY3Qgd2l0aCBvcHRpb25zIGZvciB5b3VyIHVwZGF0ZSBzdGF0ZW1lbnRcbiAgICogQHJldHVybnNcbiAgICogQGFzeW5jXG4gICAqL1xuICBidWxrVXBkYXRlID0gYXN5bmMgKFxuICAgIHRhYmxlOiBzdHJpbmcsXG4gICAgcmVjb3JkczogQWlydGFibGVVcGRhdGVSZWNvcmRbXSxcbiAgICBvcHRzPzogdXBkYXRlT3B0cyxcbiAgKTogUHJvbWlzZTxBaXJ0YWJsZVJlY29yZFtdPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrQXJnKHRhYmxlLCAndGFibGUnLCAnc3RyaW5nJyk7XG4gICAgICBjaGVja0FyZyhyZWNvcmRzLCAncmVjb3JkcycsICdhcnJheScpO1xuICAgICAgaWYgKG9wdHMpIHtcbiAgICAgICAgY2hlY2tBcmcob3B0cy5kZXN0cnVjdGl2ZSwgJ29wdHMuZGVzY3RydWN0aXZlJywgJ2Jvb2xlYW4nLCBmYWxzZSk7XG4gICAgICAgIGNoZWNrQXJnKG9wdHMudHlwZWNhc3QsICdvcHRzLnR5cGVjYXN0JywgJ2Jvb2xlYW4nLCBmYWxzZSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1cmwgPSBgJHtiYXNlVVJMfS8ke3RoaXMuYmFzZX0vJHt0YWJsZX1gO1xuICAgICAgY29uc3QgYm9keTogYnVsa1F1ZXJ5Qm9keSA9IHsgcmVjb3JkcyB9O1xuICAgICAgaWYgKG9wdHM/LnR5cGVjYXN0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgYm9keS50eXBlY2FzdCA9IG9wdHM/LnR5cGVjYXN0O1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzOiBSZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICBtZXRob2Q6IG9wdHM/LmRlc3RydWN0aXZlID8gJ3B1dCcgOiAncGF0Y2gnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGRhdGE6IEFpcnRhYmxlUmVjb3JkUmVzcG9uc2UgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgaWYgKGNoZWNrRXJyb3IocmVzLnN0YXR1cykpIHtcbiAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDQyOSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5yZXRyeU9uUmF0ZUxpbWl0KSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHJhdGVMaW1pdEhhbmRsZXIoXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIG1ldGhvZDogb3B0cz8uZGVzdHJ1Y3RpdmUgPyAncHV0JyA6ICdwYXRjaCcsXG4gICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aGlzLnJldHJ5VGltZW91dCxcbiAgICAgICAgICAgIHRoaXMubWF4UmV0cnksXG4gICAgICAgICAgICAncmVjb3JkcycsXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGEucmVjb3JkcztcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnIpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogRGVsZXRlcyBtdWx0aXBsZSByZWNvcmRzIGZyb20gdGhlIHNwZWNpZmllZCB0YWJsZVxuICAgKiBAcGFyYW0gdGFibGUgLSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSBpZHMgLSBBcnJheSBvZiBBaXJ0YWJsZSByZWNvcmQgSURzXG4gICAqIEByZXR1cm5zXG4gICAqIEBhc3luY1xuICAgKi9cbiAgYnVsa0RlbGV0ZSA9IGFzeW5jIChcbiAgICB0YWJsZTogc3RyaW5nLFxuICAgIGlkczogc3RyaW5nW10sXG4gICk6IFByb21pc2U8RGVsZXRlUmVzcG9uc2VbXT4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBjaGVja0FyZyh0YWJsZSwgJ3RhYmxlJywgJ3N0cmluZycpO1xuICAgICAgY2hlY2tBcmcoaWRzLCAnaWRzJywgJ2FycmF5Jyk7XG4gICAgICBsZXQgcXVlcnkgPSAnJztcbiAgICAgIGlkcy5mb3JFYWNoKChpZCwgaSkgPT4ge1xuICAgICAgICBpZiAoaSAhPT0gMCkge1xuICAgICAgICAgIHF1ZXJ5ID0gYCR7cXVlcnl9JnJlY29yZHNbXT0ke2lkfWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcXVlcnkgPSBgcmVjb3Jkc1tdPSR7aWR9YDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBjb25zdCB1cmwgPSBgJHtiYXNlVVJMfS8ke3RoaXMuYmFzZX0vJHt0YWJsZX0/JHtlbmNvZGVVUkkocXVlcnkpfWA7XG4gICAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgZGF0YTogQWlydGFibGVEZWxldGVkUmVzcG9uc2UgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgaWYgKGNoZWNrRXJyb3IocmVzLnN0YXR1cykpIHtcbiAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDQyOSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5yZXRyeU9uUmF0ZUxpbWl0KSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHJhdGVMaW1pdEhhbmRsZXIoXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aGlzLnJldHJ5VGltZW91dCxcbiAgICAgICAgICAgIHRoaXMubWF4UmV0cnksXG4gICAgICAgICAgICAncmVjb3JkcycsXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGEucmVjb3JkcztcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnIpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGEgcmVjb3JkIGV4aXN0cywgYW5kIGlmIGl0IGRvZXMgdXBkYXRlcyBpdCwgaWYgbm90IGNyZWF0ZXMgYSBuZXcgcmVjb3JkLlxuICAgKiBAcGFyYW0gdGFibGUgLSBUYWJsZSBuYW1lXG4gICAqIEBwYXJhbSBmaWx0ZXJTdHJpbmcgLSBUaGUgZmlsdGVyIGZvcm11bGEgc3RyaW5nIHVzZWQgdG8gY2hlY2sgZm9yIGEgcmVjb3JkXG4gICAqIEBwYXJhbSByZWNvcmQgLSBSZWNvcmQgb2JqZWN0IHVzZWQgdG8gZWl0aGVyIHVwZGF0ZSBvciBjcmVhdGUgYSByZWNvcmRcbiAgICogQHBhcmFtIG9wdHMgLSBBbiBvYmplY3Qgd2l0aCBvcHRpb25zIGZvciB5b3VyIHVwZGF0ZSBzdGF0ZW1lbnRcbiAgICogQHJldHVybnNcbiAgICogQGFzeW5jXG4gICAqL1xuICB1cHNlcnRSZWNvcmQgPSBhc3luYyAoXG4gICAgdGFibGU6IHN0cmluZyxcbiAgICBmaWx0ZXJTdHJpbmc6IHN0cmluZyxcbiAgICByZWNvcmQ6IEZpZWxkcyxcbiAgICBvcHRzPzogdXBkYXRlT3B0cyxcbiAgKTogUHJvbWlzZTxBaXJ0YWJsZVJlY29yZD4gPT4ge1xuICAgIGNoZWNrQXJnKHRhYmxlLCAndGFibGUnLCAnc3RyaW5nJyk7XG4gICAgY2hlY2tBcmcoZmlsdGVyU3RyaW5nLCAnZmlsdGVyU3RyaW5nJywgJ3N0cmluZycpO1xuICAgIGNoZWNrQXJnKHJlY29yZCwgJ3JlY29yZCcsICdvYmplY3QnKTtcbiAgICBpZiAob3B0cykge1xuICAgICAgY2hlY2tBcmcob3B0cy5kZXN0cnVjdGl2ZSwgJ29wdHMuZGVzY3RydWN0aXZlJywgJ2Jvb2xlYW4nLCBmYWxzZSk7XG4gICAgICBjaGVja0FyZyhvcHRzLnR5cGVjYXN0LCAnb3B0cy50eXBlY2FzdCcsICdib29sZWFuJywgZmFsc2UpO1xuICAgIH1cbiAgICBjb25zdCBleGlzdHMgPSBhd2FpdCB0aGlzLnNlbGVjdCh0YWJsZSwgeyBmaWx0ZXJCeUZvcm11bGE6IGZpbHRlclN0cmluZyB9KTtcbiAgICBpZiAoIWV4aXN0c1swXSkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuY3JlYXRlUmVjb3JkKHRhYmxlLCByZWNvcmQsIG9wdHM/LnR5cGVjYXN0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMudXBkYXRlUmVjb3JkKFxuICAgICAgICB0YWJsZSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiBleGlzdHNbMF0uaWQsXG4gICAgICAgICAgZmllbGRzOiByZWNvcmQsXG4gICAgICAgIH0sXG4gICAgICAgIG9wdHMsXG4gICAgICApO1xuICAgIH1cbiAgfTtcbn1cblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gIHdpbmRvdy5Bc3luY0FpcnRhYmxlID0gQXN5bmNBaXJ0YWJsZTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=